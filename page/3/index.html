<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="King">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="King">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="King">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>King</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">King</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">xianxiaotao</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/03/Custom View/03.1 精通自定义 View 之属性动画（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/03/Custom View/03.1 精通自定义 View 之属性动画（一）/" itemprop="url">03.1 精通自定义 View 之属性动画（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-03T01:00:00+08:00">
                2019-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="3-1-ValueAnimator-的基本使用"><a href="#3-1-ValueAnimator-的基本使用" class="headerlink" title="3.1 ValueAnimator 的基本使用"></a>3.1 ValueAnimator 的基本使用</h2><h4 id="3-1-1-概述"><a href="#3-1-1-概述" class="headerlink" title="3.1.1 概述"></a>3.1.1 概述</h4><p>Animation：</p>
<ul>
<li>View Animation（视图动画，API Level 1）<br>|—- Tween Animation（补间动画）<br>|—- Frame Animation（逐帧动画）</li>
<li>Property Animation（属性动画，API Level 11）<br>|—- ValueAnimator<br>|—- ObjectAnimator</li>
</ul>
<p>视图动画仅能对指定的控件做动画，而属性动画是通过改变控件的某一属性值来做动画的。视图动画还有一个缺陷，就是只能点击原始区域才能响应事件。</p>
<h4 id="3-1-2-ValueAnimator-的简单使用"><a href="#3-1-2-ValueAnimator-的简单使用" class="headerlink" title="3.1.2 ValueAnimator 的简单使用"></a>3.1.2 ValueAnimator 的简单使用</h4><p>ValueAnimator 不会对控件执行任何操作，我们可以给它设定从哪个值运动到哪个值，通过监听这些值的渐变过程来使自己操作控件。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-17e5c9ef09ea60ec.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends AppCompatActivity &#123;</div><div class="line"></div><div class="line">    private TextView mView;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.act_main);</div><div class="line"></div><div class="line">        mView = findViewById(R.id.tv);</div><div class="line">        findViewById(R.id.start_btn).setOnClickListener(new View.OnClickListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                doAnimation();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        mView.setOnClickListener(new View.OnClickListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                Toast.makeText(MainActivity.this, &quot;你逮到我了&quot;, Toast.LENGTH_SHORT).show();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void doAnimation() &#123;</div><div class="line">        final int left, top;</div><div class="line">        left = mView.getLeft();</div><div class="line">        top = mView.getTop();</div><div class="line"></div><div class="line">        ValueAnimator animator = ValueAnimator.ofInt(0, 400, 200);</div><div class="line">        animator.setDuration(2000);</div><div class="line">        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onAnimationUpdate(ValueAnimator animation) &#123;</div><div class="line">                int curValue = (Integer) animation.getAnimatedValue();</div><div class="line">                mView.layout(curValue + left, curValue + top,</div><div class="line">                        curValue + left + mView.getWidth(),</div><div class="line">                        curValue + top + mView.getHeight());</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        animator.start();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>ValueAnimator 只负责对指定值区间进行动画运算，我们需要对运算过程进行监听，然后自己对控件执行动画操作；动画结束后，控件仍然可以响应单击事件。</p>
</blockquote>
<h4 id="3-1-3-常用函数"><a href="#3-1-3-常用函数" class="headerlink" title="3.1.3 常用函数"></a>3.1.3 常用函数</h4><h5 id="1-ofInt-与-ofFloat"><a href="#1-ofInt-与-ofFloat" class="headerlink" title="1. ofInt 与 ofFloat"></a>1. ofInt 与 ofFloat</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public static ValueAnimator ofInt(int... values)</div><div class="line">public static ValueAnimator ofFloat(float... values)</div></pre></td></tr></table></figure>
<p>参数类型都是可变长参数，如上例中的 ofInt(0, 400, 200) 就表示从数字 0 变化到数字 400 再变化到 200。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public Object getAnimatedValue()</div></pre></td></tr></table></figure></p>
<p>上例中可以强转为 Integer 是因为使用的是 ofInt 方法设定动画初始值。当使用 ofFloat 函数设定初始值后，则需要强转为 Float 类型。后面介绍的 ofObject 函数也是如此。</p>
<h5 id="2-常用函数"><a href="#2-常用函数" class="headerlink" title="2. 常用函数"></a>2. 常用函数</h5><table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ValueAnimator setDuration(long duration)</td>
<td style="text-align:left">设置动画时长，单位是毫秒</td>
</tr>
<tr>
<td style="text-align:left">Object getAnimatedValue()</td>
<td style="text-align:left">获取 ValueAnimator 在运动时当前运动点的值</td>
</tr>
<tr>
<td style="text-align:left">void start()</td>
<td style="text-align:left">开始动画</td>
</tr>
<tr>
<td style="text-align:left">void cancel()</td>
<td style="text-align:left">取消动画</td>
</tr>
<tr>
<td style="text-align:left">void setRepeatCount(int value)</td>
<td style="text-align:left">循环次数，ValueAnimator.INFINITE 表示无线循环</td>
</tr>
<tr>
<td style="text-align:left">void setRepeatMode(int value)</td>
<td style="text-align:left">循环模式：ValueAnimator.RESTART、REVERSE</td>
</tr>
<tr>
<td style="text-align:left">void setStartDelay(long startDelay)</td>
<td style="text-align:left">延时多久开始，毫秒</td>
</tr>
<tr>
<td style="text-align:left">ValueAnimator clone()</td>
<td style="text-align:left">完全克隆一个 ValueAnimator 示例，包括所有设置和对监听器代码的处理。</td>
</tr>
</tbody>
</table>
<h5 id="3-监听器"><a href="#3-监听器" class="headerlink" title="3. 监听器"></a>3. 监听器</h5><p>1）添加监听器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">// 监听器一：监听动画过程中值的实时变化</div><div class="line">animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;</div><div class="line">    @Override</div><div class="line">    public void onAnimationUpdate(ValueAnimator animation) &#123;</div><div class="line">        // doSomething</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 监听器二：监听动画变化时的 4 个状态</div><div class="line">animator.addListener(new Animator.AnimatorListener() &#123;</div><div class="line">    @Override</div><div class="line">    public void onAnimationStart(Animator animation) &#123;&#125;</div><div class="line">    @Override</div><div class="line">    public void onAnimationEnd(Animator animation) &#123;&#125;</div><div class="line">    @Override</div><div class="line">    public void onAnimationCancel(Animator animation) &#123;&#125;</div><div class="line">    @Override</div><div class="line">    public void onAnimationRepeat(Animator animation) &#123;&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>2）移除监听器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// 移除 AnimatorUpdateListener</div><div class="line">void removeUpdateListener(AnimatorUpdateListener listener);</div><div class="line">void removeAllUpdateListeners();</div><div class="line"></div><div class="line">// 移除 AnimatorListener</div><div class="line">void removeListener(AnimatorListener listener);</div><div class="line">void removeAllListeners();</div></pre></td></tr></table></figure></p>
<h4 id="3-1-4-示例：弹跳加载中效果"><a href="#3-1-4-示例：弹跳加载中效果" class="headerlink" title="3.1.4 示例：弹跳加载中效果"></a>3.1.4 示例：弹跳加载中效果</h4><p><img src="https://upload-images.jianshu.io/upload_images/14186083-b02f17acf6a8f20a.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>自定义 LoadingImageView.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">public class LoadingImageView extends AppCompatImageView &#123;</div><div class="line"></div><div class="line">    private int mTop;</div><div class="line">    // 当前动画图片索引</div><div class="line">    private int mCurImgIndex = 0;</div><div class="line">    // 动画图片总张数</div><div class="line">    private static int mImgCount = 3;</div><div class="line"></div><div class="line">    public LoadingImageView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void init() &#123;</div><div class="line">        ValueAnimator animator = ValueAnimator.ofInt(0, 200, 0);</div><div class="line">        animator.setRepeatCount(ValueAnimator.INFINITE);</div><div class="line">        animator.setRepeatMode(ValueAnimator.RESTART);</div><div class="line">        animator.setDuration(2000);</div><div class="line">        animator.setInterpolator(new AccelerateDecelerateInterpolator());</div><div class="line">        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onAnimationUpdate(ValueAnimator animation) &#123;</div><div class="line">                int dx = (Integer) animation.getAnimatedValue();</div><div class="line">                setTop(mTop - dx);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        animator.addListener(new Animator.AnimatorListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onAnimationStart(Animator animation) &#123;</div><div class="line">                setImageDrawable(getResources().getDrawable(R.drawable.pic_1));</div><div class="line">            &#125;</div><div class="line">            @Override</div><div class="line">            public void onAnimationEnd(Animator animation) &#123;&#125;</div><div class="line">            @Override</div><div class="line">            public void onAnimationCancel(Animator animation) &#123;&#125;</div><div class="line">            @Override</div><div class="line">            public void onAnimationRepeat(Animator animation) &#123;</div><div class="line">                mCurImgIndex++;</div><div class="line">                                switch (mCurImgIndex % mImgCount) &#123;</div><div class="line">                    case 0:</div><div class="line">                        // setImageDrawable(getResources().getDrawable(R.drawable.pic_1));</div><div class="line">                        setImageDrawable(ResourcesCompat.getDrawable(</div><div class="line">                                getResources(), R.drawable.pic_1, null));</div><div class="line">                        break;</div><div class="line">                    case 1:</div><div class="line">                        setImageDrawable(ResourcesCompat.getDrawable(</div><div class="line">                                getResources(), R.drawable.pic_2, null));</div><div class="line">                        break;</div><div class="line">                    case 2:</div><div class="line">                        setImageDrawable(ResourcesCompat.getDrawable(</div><div class="line">                                getResources(), R.drawable.pic_3, null));</div><div class="line">                        break;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        animator.start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123;</div><div class="line">        super.onLayout(changed, left, top, right, bottom);</div><div class="line">        mTop = top;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>act_main.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;LinearLayout</div><div class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;</div><div class="line">    android:layout_gravity=&quot;center_horizontal&quot;</div><div class="line">    android:orientation=&quot;vertical&quot;&gt;</div><div class="line">    &lt;com.xxt.xtest.LoadingImageView</div><div class="line">        android:layout_width=&quot;50dp&quot;</div><div class="line">        android:layout_height=&quot;50dp&quot;</div><div class="line">        android:layout_marginTop=&quot;100dp&quot;</div><div class="line">        android:layout_gravity=&quot;center_horizontal&quot;</div><div class="line">        android:src=&quot;@drawable/pic_1&quot;/&gt;</div><div class="line">    &lt;TextView</div><div class="line">        android:layout_width=&quot;wrap_content&quot;</div><div class="line">        android:layout_height=&quot;wrap_content&quot;</div><div class="line">        android:layout_gravity=&quot;center_horizontal&quot;</div><div class="line">        android:layout_marginTop=&quot;10dp&quot;</div><div class="line">        android:gravity=&quot;center&quot;</div><div class="line">        android:text=&quot;加载中...&quot;/&gt;</div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/02/Custom View/02.4 精通自定义 View 之视图动画（四）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/02/Custom View/02.4 精通自定义 View 之视图动画（四）/" itemprop="url">02.4 精通自定义 View 之视图动画（四）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-02T10:00:00+08:00">
                2019-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="2-4-动画示例"><a href="#2-4-动画示例" class="headerlink" title="2.4 动画示例"></a>2.4 动画示例</h2><h4 id="2-4-1-镜头由远及近效果"><a href="#2-4-1-镜头由远及近效果" class="headerlink" title="2.4.1 镜头由远及近效果"></a>2.4.1 镜头由远及近效果</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends AppCompatActivity &#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.act_main);</div><div class="line"></div><div class="line">        ScaleAnimation scaleAnim = new ScaleAnimation(1.0f, 3f, 1.0f, 3f,</div><div class="line">                Animation.RELATIVE_TO_SELF, 0.4f,</div><div class="line">                Animation.RELATIVE_TO_PARENT, 0.8f);</div><div class="line">        scaleAnim.setDuration(6000);</div><div class="line">        scaleAnim.setFillAfter(true);</div><div class="line">        scaleAnim.setInterpolator(new BounceInterpolator());</div><div class="line">        findViewById(R.id.image).startAnimation(scaleAnim);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>act_main.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;LinearLayout</div><div class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;</div><div class="line">    android:orientation=&quot;vertical&quot;&gt;</div><div class="line">    &lt;ImageView</div><div class="line">        android:id=&quot;@+id/image&quot;</div><div class="line">        android:layout_width=&quot;match_parent&quot;</div><div class="line">        android:layout_height=&quot;match_parent&quot;</div><div class="line">        android:scaleType=&quot;fitXY&quot;</div><div class="line">        android:src=&quot;@drawable/meinv&quot;/&gt;</div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure></p>
<p>效果图如下：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-b65cc033055b387b.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-4-2-加载框效果"><a href="#2-4-2-加载框效果" class="headerlink" title="2.4.2 加载框效果"></a>2.4.2 加载框效果</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends AppCompatActivity &#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.act_main);</div><div class="line"></div><div class="line">        RotateAnimation rotateAnim = new RotateAnimation(0, 360,</div><div class="line">                Animation.RELATIVE_TO_SELF, 0.5f, </div><div class="line">                Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line">        rotateAnim.setRepeatCount(Animation.INFINITE);</div><div class="line">        rotateAnim.setDuration(2000);</div><div class="line">        rotateAnim.setInterpolator(new LinearInterpolator());</div><div class="line">        findViewById(R.id.loading).startAnimation(rotateAnim);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;RelativeLayout</div><div class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;&gt;</div><div class="line">    &lt;ImageView</div><div class="line">        android:id=&quot;@+id/loading&quot;</div><div class="line">        android:layout_width=&quot;wrap_content&quot;</div><div class="line">        android:layout_height=&quot;wrap_content&quot;</div><div class="line">        android:layout_centerHorizontal=&quot;true&quot;</div><div class="line">        android:layout_marginTop=&quot;50dp&quot;</div><div class="line">        android:src=&quot;@drawable/loading&quot;/&gt;</div><div class="line">&lt;/RelativeLayout&gt;</div></pre></td></tr></table></figure>
<p>效果图如下：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-97840b9e023e724a.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-4-3-扫描动画"><a href="#2-4-3-扫描动画" class="headerlink" title="2.4.3 扫描动画"></a>2.4.3 扫描动画</h4><p><img src="https://upload-images.jianshu.io/upload_images/14186083-dda8bf5509252728.gif?imageMogr2/auto-orient/strip" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends AppCompatActivity &#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.act_main);</div><div class="line"></div><div class="line">        final Animation anim1 = AnimationUtils.loadAnimation(MainActivity.this, R.anim.scale_alpha_anim);</div><div class="line">        final Animation anim2 = AnimationUtils.loadAnimation(MainActivity.this, R.anim.scale_alpha_anim);</div><div class="line">        final Animation anim3 = AnimationUtils.loadAnimation(MainActivity.this, R.anim.scale_alpha_anim);</div><div class="line">        final Animation anim4 = AnimationUtils.loadAnimation(MainActivity.this, R.anim.scale_alpha_anim);</div><div class="line"></div><div class="line">        findViewById(R.id.start_can).setOnClickListener(new View.OnClickListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                findViewById(R.id.circle1).startAnimation(anim1);</div><div class="line">                anim2.setStartOffset(500);</div><div class="line">                findViewById(R.id.circle2).startAnimation(anim2);</div><div class="line">                anim3.setStartOffset(1000);</div><div class="line">                findViewById(R.id.circle3).startAnimation(anim3);</div><div class="line">                anim4.setStartOffset(1500);</div><div class="line">                findViewById(R.id.circle4).startAnimation(anim4);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>act_main.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;RelativeLayout</div><div class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;&gt;</div><div class="line">    &lt;View</div><div class="line">        android:id=&quot;@+id/circle1&quot;</div><div class="line">        android:layout_width=&quot;130dp&quot;</div><div class="line">        android:layout_height=&quot;130dp&quot;</div><div class="line">        android:layout_centerHorizontal=&quot;true&quot;</div><div class="line">        android:layout_marginTop=&quot;70dp&quot;</div><div class="line">        android:background=&quot;@drawable/scan_circle&quot;/&gt;</div><div class="line">    &lt;View</div><div class="line">        android:id=&quot;@+id/circle2&quot;</div><div class="line">        android:layout_width=&quot;130dp&quot;</div><div class="line">        android:layout_height=&quot;130dp&quot;</div><div class="line">        android:layout_centerHorizontal=&quot;true&quot;</div><div class="line">        android:layout_marginTop=&quot;70dp&quot;</div><div class="line">        android:background=&quot;@drawable/scan_circle&quot;/&gt;</div><div class="line">    &lt;View</div><div class="line">        android:id=&quot;@+id/circle3&quot;</div><div class="line">        android:layout_width=&quot;130dp&quot;</div><div class="line">        android:layout_height=&quot;130dp&quot;</div><div class="line">        android:layout_centerHorizontal=&quot;true&quot;</div><div class="line">        android:layout_marginTop=&quot;70dp&quot;</div><div class="line">        android:background=&quot;@drawable/scan_circle&quot;/&gt;</div><div class="line">    &lt;View</div><div class="line">        android:id=&quot;@+id/circle4&quot;</div><div class="line">        android:layout_width=&quot;130dp&quot;</div><div class="line">        android:layout_height=&quot;130dp&quot;</div><div class="line">        android:layout_centerHorizontal=&quot;true&quot;</div><div class="line">        android:layout_marginTop=&quot;70dp&quot;</div><div class="line">        android:background=&quot;@drawable/scan_circle&quot;/&gt;</div><div class="line">    &lt;ImageView</div><div class="line">        android:id=&quot;@+id/start_can&quot;</div><div class="line">        android:layout_width=&quot;130dp&quot;</div><div class="line">        android:layout_height=&quot;130dp&quot;</div><div class="line">        android:layout_centerHorizontal=&quot;true&quot;</div><div class="line">        android:layout_marginTop=&quot;70dp&quot;</div><div class="line">        android:src=&quot;@drawable/music&quot;/&gt;</div><div class="line">&lt;/RelativeLayout&gt;</div></pre></td></tr></table></figure></p>
<p>scan_circle.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:shape=&quot;oval&quot;&gt;</div><div class="line">    &lt;solid android:color=&quot;#FF6C2F&quot;/&gt;</div><div class="line">&lt;/shape&gt;</div></pre></td></tr></table></figure></p>
<p>scale_alpha_anim.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;set xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:duration=&quot;2000&quot;&gt;</div><div class="line">    &lt;alpha</div><div class="line">        android:repeatCount=&quot;infinite&quot;</div><div class="line">        android:fromAlpha=&quot;0.4&quot;</div><div class="line">        android:toAlpha=&quot;0&quot;/&gt;</div><div class="line">    &lt;scale</div><div class="line">        android:repeatCount=&quot;infinite&quot;</div><div class="line">        android:fromXScale=&quot;1.0&quot;</div><div class="line">        android:fromYScale=&quot;1.0&quot;</div><div class="line">        android:toXScale=&quot;3&quot;</div><div class="line">        android:toYScale=&quot;3&quot;</div><div class="line">        android:pivotX=&quot;50%&quot;</div><div class="line">        android:pivotY=&quot;50%&quot; /&gt;</div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure></p>
<h2 id="2-5-逐帧动画"><a href="#2-5-逐帧动画" class="headerlink" title="2.5 逐帧动画"></a>2.5 逐帧动画</h2><h4 id="2-5-1-XML-实现"><a href="#2-5-1-XML-实现" class="headerlink" title="2.5.1 XML 实现"></a>2.5.1 XML 实现</h4><p>新建一个动画 XML 文件，在文件中使用 <animation-list> 标签来定义动画帧序列，使用 <item> 标签来定义动画的每一帧，并在其中指定帧的持续时间等属性。</item></animation-list></p>
<h6 id="1）定义-XML-动画文件"><a href="#1）定义-XML-动画文件" class="headerlink" title="1）定义 XML 动画文件"></a>1）定义 XML 动画文件</h6><p>res/drawable/playing_anim.xml 或 res/anim/playing_anim.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;animation-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:oneshot=&quot;false&quot;&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img00&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img01&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img02&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img03&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img04&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img05&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img06&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img07&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img08&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img10&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img11&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img12&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img13&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img14&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img15&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img16&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img17&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img18&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img19&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img20&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img21&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img22&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img23&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">    &lt;item android:drawable=&quot;@mipmap/img24&quot; android:duration=&quot;120&quot; /&gt;</div><div class="line">&lt;/animation-list&gt;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>oneshot 用来控制动画是否循环播放，如果取值为 true，表示动画不会循环播放，否则动画会循环播放；duration 用来指定每一帧的持续播放时间。</p>
</blockquote>
<h6 id="2）设置-ImageView"><a href="#2）设置-ImageView" class="headerlink" title="2）设置 ImageView"></a>2）设置 ImageView</h6><p>设置动画资源有两种方式：android:src、android:background。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;ImageView</div><div class="line">    android:id=&quot;@+id/frame_image&quot;</div><div class="line">    android:layout_width=&quot;wrap_content&quot;</div><div class="line">    android:layout_height=&quot;wrap_content&quot;</div><div class="line">    android:src=&quot;@drawable/playing_anim&quot;/&gt;</div></pre></td></tr></table></figure></p>
<h6 id="3）AnimationDrawable-开始动画"><a href="#3）AnimationDrawable-开始动画" class="headerlink" title="3）AnimationDrawable 开始动画"></a>3）AnimationDrawable 开始动画</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ImageView image = findViewById(R.id.frame_image);</div><div class="line">AnimationDrawable anim = (AnimationDrawable) image.getDrawable();</div><div class="line">anim.start();</div></pre></td></tr></table></figure>
<blockquote>
<p>注意：<br>android:src 对应 image.getDrawable()；<br>android:background 对应 image.getBackground();</p>
</blockquote>
<h4 id="2-5-2-代码实现"><a href="#2-5-2-代码实现" class="headerlink" title="2.5.2 代码实现"></a>2.5.2 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">AnimationDrawable animationDrawable = new AnimationDrawable();</div><div class="line">int id = 0;</div><div class="line">for (int i = 0; i &lt; 24; i++) &#123;</div><div class="line">    if (i &lt; 10) &#123;</div><div class="line">        id = getResources().getIdentifier(&quot;img0&quot; + i, &quot;mipmap&quot;, </div><div class="line">                getPackageName());</div><div class="line">    &#125; else  &#123;</div><div class="line">        id = getResources().getIdentifier(&quot;img&quot; + i, &quot;mipmap&quot;, </div><div class="line">                getPackageName());</div><div class="line">    &#125;</div><div class="line">    Drawable drawable = getResources().getDrawable(id);</div><div class="line">    animationDrawable.addFrame(drawable, 120);</div><div class="line">&#125;</div><div class="line">image.setImageDrawable(animationDrawable);</div><div class="line">animationDrawable.setOneShot(false);</div><div class="line">animationDrawable.start();</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/6770217-058c430641bcb12d.gif?imageMogr2/auto-orient/strip|imageView2/2/w/360/format/webp" alt=""></p>
<blockquote>
<p>帧动画使用比较简单，但是容易引起 OOM，在使用帧动画时应该尽量避免使用过多尺寸较大的图片。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/02/Custom View/02.3 精通自定义 View 之视图动画（三）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/02/Custom View/02.3 精通自定义 View 之视图动画（三）/" itemprop="url">02.3 精通自定义 View 之视图动画（三）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-02T09:00:00+08:00">
                2019-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="2-3-插值器初探"><a href="#2-3-插值器初探" class="headerlink" title="2.3 插值器初探"></a>2.3 插值器初探</h2><p>有关动画的变化速率的问题是由 Interpolator 类来决定的。Interpolator 叫插值器，也叫加速器，是用来指定动画如何变化的变量。它只是一个接口，通过实现这个接口就可以自定义动画的变化速率。系统提供了如下几个实现了插值器的类：</p>
<table>
<thead>
<tr>
<th style="text-align:left">nterpolator class</th>
<th style="text-align:left">Resource ID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">AccelerateDecelerateInterpolator</td>
<td style="text-align:left">@android:anim/accelerate_decelerate_interpolator</td>
</tr>
<tr>
<td style="text-align:left">AccelerateInterpolator</td>
<td style="text-align:left">@android:anim/accelerate_interpolator</td>
</tr>
<tr>
<td style="text-align:left">DecelerateInterpolator</td>
<td style="text-align:left">@android:anim/decelerate_interpolator</td>
</tr>
<tr>
<td style="text-align:left">LinearInterpolator</td>
<td style="text-align:left">@android:anim/linear_interpolator</td>
</tr>
<tr>
<td style="text-align:left">BounceInterpolator</td>
<td style="text-align:left">@android:anim/bounce_interpolator</td>
</tr>
<tr>
<td style="text-align:left">AnticipateInterpolator</td>
<td style="text-align:left">@android:anim/anticipate_interpolator</td>
</tr>
<tr>
<td style="text-align:left">OvershootInterpolator</td>
<td style="text-align:left">@android:anim/overshoot_interpolator</td>
</tr>
<tr>
<td style="text-align:left">AnticipateOvershootInterpolator</td>
<td style="text-align:left">@android:anim/anticipate_overshoot_interpolator</td>
</tr>
<tr>
<td style="text-align:left">CycleInterpolator</td>
<td style="text-align:left">@android:anim/cycle_interpolator</td>
</tr>
</tbody>
</table>
<p>关于插值器，有两种使用方法。</p>
<h6 id="方法一、在-XML-文件中引用插值器"><a href="#方法一、在-XML-文件中引用插值器" class="headerlink" title="方法一、在 XML 文件中引用插值器"></a>方法一、在 XML 文件中引用插值器</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;alpha xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromAlpha=&quot;1.0&quot;</div><div class="line">    android:toAlpha=&quot;0.1&quot;</div><div class="line">    android:duration=&quot;3000&quot;</div><div class="line">    android:interpolator=&quot;@android:anim/accelerate_interpolator&quot;/&gt;</div></pre></td></tr></table></figure>
<h6 id="方法二、通过-setInterpolator-函数设置插值器"><a href="#方法二、通过-setInterpolator-函数设置插值器" class="headerlink" title="方法二、通过 setInterpolator() 函数设置插值器"></a>方法二、通过 setInterpolator() 函数设置插值器</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">AlphaAnimation alphaAnim = new AlphaAnimation(1.0f, 0.1f);</div><div class="line">alphaAnim.setDuration(3000);</div><div class="line">alphaAnim.setInterpolator(new LinearInterpolator());</div></pre></td></tr></table></figure>
<h4 id="2-3-1-AccelerateDecelerateInterpolator"><a href="#2-3-1-AccelerateDecelerateInterpolator" class="headerlink" title="2.3.1 AccelerateDecelerateInterpolator"></a>2.3.1 AccelerateDecelerateInterpolator</h4><p>加速减速插值器，表示在开始与结束的地方速率改变比较慢，在中间的时候加速。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">TranslateAnimation alphaAnim = new TranslateAnimation(</div><div class="line">        Animation.RELATIVE_TO_SELF, 0, Animation.RELATIVE_TO_PARENT, 0.5f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0, Animation.RELATIVE_TO_PARENT, 0.5f);</div><div class="line">alphaAnim.setDuration(2000);</div><div class="line">alphaAnim.setFillAfter(true);</div><div class="line">alphaAnim.setInterpolator(new AccelerateDecelerateInterpolator());</div><div class="line">view.startAnimation(alphaAnim);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-1a5e986db80513d8.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-2-AccelerateInterpolator"><a href="#2-3-2-AccelerateInterpolator" class="headerlink" title="2.3.2 AccelerateInterpolator"></a>2.3.2 AccelerateInterpolator</h4><p>加速插值器，表示在动画开始的地方速率比较慢，然后开始加速。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new AccelerateInterpolator());</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-908e70cfe467c264.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-3-DecelerateInterpolator"><a href="#2-3-3-DecelerateInterpolator" class="headerlink" title="2.3.3 DecelerateInterpolator"></a>2.3.3 DecelerateInterpolator</h4><p>减速插值器，表示在动画开始的一瞬间加速到最大值，然后逐渐变慢。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new DecelerateInterpolator());</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-6d0ff5568b75446f.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-4-LinearInterpolator"><a href="#2-3-4-LinearInterpolator" class="headerlink" title="2.3.4 LinearInterpolator"></a>2.3.4 LinearInterpolator</h4><p>线性插值器，也称匀速插值器，显然，它的速率是保持恒定的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new LinearInterpolator());</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-377ec8feea0f4d15.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-5-BounceInterpolator"><a href="#2-3-5-BounceInterpolator" class="headerlink" title="2.3.5 BounceInterpolator"></a>2.3.5 BounceInterpolator</h4><p>弹跳插值器，模拟了控件自由落地后回弹的效果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new BounceInterpolator());</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-41e10e83f1b030b5.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-6-AnticipateInterpolator"><a href="#2-3-6-AnticipateInterpolator" class="headerlink" title="2.3.6 AnticipateInterpolator"></a>2.3.6 AnticipateInterpolator</h4><p>初始偏移插值器，表示在动画开始的时候向前偏移一段距离，然后应用动画。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public AnticipateInterpolator()</div><div class="line">public AnticipateInterpolator(float tension)</div></pre></td></tr></table></figure></p>
<p>参数 float tension 对应的 XML 属性为 android:tension，表示张力值，默认值为 2。值越大，初始的偏移量越大，而且速度越快。0 表示不偏移。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new AnticipateInterpolator(4));</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-238aad363372258f.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-7-OvershootInterpolator"><a href="#2-3-7-OvershootInterpolator" class="headerlink" title="2.3.7 OvershootInterpolator"></a>2.3.7 OvershootInterpolator</h4><p>结束偏移插值器，表示在动画结束的时候沿动画方向继续运动一段距离后再结束动画。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public OvershootInterpolator()</div><div class="line">public OvershootInterpolator(float tension)</div></pre></td></tr></table></figure></p>
<p>参数 float tension 对应的 XML 属性为 android:tension，表示张力值，默认值为 2。值越大，结束时的偏移量越大。0 表示不偏移。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new OvershootInterpolator());</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-f1c535299a35ee11.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-8-AnticipateOvershootInterpolator"><a href="#2-3-8-AnticipateOvershootInterpolator" class="headerlink" title="2.3.8 AnticipateOvershootInterpolator"></a>2.3.8 AnticipateOvershootInterpolator</h4><p>是 AnticipateInterpolator 和 OvershootInterpolator 的合体，即在动画开始时向前偏移一段距离后，在动画结束的时候沿动画方向继续运动一段距离后再结束动画。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public AnticipateOvershootInterpolator()</div><div class="line">public AnticipateOvershootInterpolator(float tension)</div><div class="line">public AnticipateOvershootInterpolator(float tension, float extraTension)</div></pre></td></tr></table></figure></p>
<ul>
<li>参数 float tension 对应的 XML 属性为 android:tension，表示张力值，默认值为 2。值越大，初始和结束的偏移量越大。0 表示不偏移。</li>
<li>参数 float extraTension 对应的 XML 属性为 android:extraTension，表示额外张力值，默认值为 1.5。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alphaAnim.setInterpolator(new AnticipateOvershootInterpolator());</div></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-c3efadfe7e3bb00a.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-3-9-CycleInterpolator"><a href="#2-3-9-CycleInterpolator" class="headerlink" title="2.3.9 CycleInterpolator"></a>2.3.9 CycleInterpolator</h4><p>循环插值器，表示动画循环播放特定的次数，速率沿正弦曲线改变。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">TranslateAnimation alphaAnim = new TranslateAnimation(</div><div class="line">        Animation.RELATIVE_TO_SELF, 0, Animation.RELATIVE_TO_PARENT, 0.5f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0, Animation.RELATIVE_TO_PARENT, 0.5f);</div><div class="line">alphaAnim.setDuration(2000);</div><div class="line">alphaAnim.setFillAfter(true);</div><div class="line">alphaAnim.setInterpolator(new CycleInterpolator());</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-5eb085b89d61c217.gif?imageMogr2/auto-orient/strip" alt=""></p>
<blockquote>
<p>虽然设置了 setFillAfter(true)，但对于 CycleInterpolator 而言并没有什么影响，动画结束后，视图还原到初始位置。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/02/Custom View/02.2 精通自定义 View 之视图动画（二）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/02/Custom View/02.2 精通自定义 View 之视图动画（二）/" itemprop="url">02.2 精通自定义 View 之视图动画（二）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-02T08:00:00+08:00">
                2019-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="2-2-视图动画的代码实现"><a href="#2-2-视图动画的代码实现" class="headerlink" title="2.2 视图动画的代码实现"></a>2.2 视图动画的代码实现</h2><h4 id="2-2-1-概述"><a href="#2-2-1-概述" class="headerlink" title="2.2.1 概述"></a>2.2.1 概述</h4><p>使用 XML 来添加动画可以很大限度地提高代码复用性，但有时只需要临时使用一个动画，就没有必要单独写一个XML动画文件了，可以使用代码的方法生成一个动画操作。</p>
<table>
<thead>
<tr>
<th style="text-align:center">标签</th>
<th style="text-align:center">类</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">scale</td>
<td style="text-align:center">ScaleAnimation</td>
</tr>
<tr>
<td style="text-align:center">alpha</td>
<td style="text-align:center">AlphaAnimation</td>
</tr>
<tr>
<td style="text-align:center">rotate</td>
<td style="text-align:center">RotateAnimation</td>
</tr>
<tr>
<td style="text-align:center">translate</td>
<td style="text-align:center">TranslateAnimation</td>
</tr>
<tr>
<td style="text-align:center">set</td>
<td style="text-align:center">AnimationSet</td>
</tr>
</tbody>
</table>
<p>Animation 类中共用的属性方法：</p>
<table>
<thead>
<tr>
<th style="text-align:left">标签属性</th>
<th style="text-align:left">方 法</th>
<th style="text-align:right">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">android:duration</td>
<td style="text-align:left">setDuration(long)</td>
<td style="text-align:right">动画的运行时间(以毫秒为单位)；必须设置</td>
</tr>
<tr>
<td style="text-align:left">android:fillAfter</td>
<td style="text-align:left">setFillAfter(boolean)</td>
<td style="text-align:right">动画结束时是否保持动画最后的状态；默认为false，优先于fillBefore</td>
</tr>
<tr>
<td style="text-align:left">android:fillBefore</td>
<td style="text-align:left">setFillBefore(boolean)</td>
<td style="text-align:right">动画结束时是否还原到开始动画前的状态；默认为true</td>
</tr>
<tr>
<td style="text-align:left">android:fillEnabled</td>
<td style="text-align:left">setFillEnabled(boolean)</td>
<td style="text-align:right">是否应用fillBefore的值，对fillAfter无影响；默认为true</td>
</tr>
<tr>
<td style="text-align:left">android:repeatCount</td>
<td style="text-align:left">setRepeatCount(int)</td>
<td style="text-align:right">重复次数，取值为整数或 Animation.INFINITE。</td>
</tr>
<tr>
<td style="text-align:left">android:repeatMode</td>
<td style="text-align:left">setRepeatMode(int)</td>
<td style="text-align:right">重复类型有两个值，reverse表示倒序回放，restart表示从头播放</td>
</tr>
<tr>
<td style="text-align:left">android:interpolator</td>
<td style="text-align:left">setInterpolator(Interpolator)</td>
<td style="text-align:right">设定插值器（指定的动画效果，譬如回弹等）</td>
</tr>
<tr>
<td style="text-align:left">android:detachWallpaper</td>
<td style="text-align:left">setDetachWallpaper(boolean)</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:left">android:startOffset</td>
<td style="text-align:left">setStartOffset(long)</td>
<td style="text-align:right">调用start函数之后等待开始运行的时间，单位为毫秒</td>
</tr>
<tr>
<td style="text-align:left">android:zAdjustment</td>
<td style="text-align:left">setZAdjustment(int)</td>
<td style="text-align:right">表示被设置动画的内容运行时在Z轴上的位置（top/bottom/normal），默认为normal</td>
</tr>
</tbody>
</table>
<h4 id="2-2-2-ScaleAnimation"><a href="#2-2-2-ScaleAnimation" class="headerlink" title="2.2.2 ScaleAnimation"></a>2.2.2 ScaleAnimation</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ScaleAnimation(float fromX, float toX, float fromY, float toY)</div><div class="line">ScaleAnimation(float fromX, float toX, float fromY, float toY, </div><div class="line">               float pivotX, float pivotY)</div><div class="line">ScaleAnimation(float fromX, float toX, float fromY, float toY,</div><div class="line">               int pivotXType, float pivotXValue, </div><div class="line">               int pivotYType, float pivotYValue)</div></pre></td></tr></table></figure>
<blockquote>
<p>pivotXType 取值为：<br>Animation.ABSOLUTE、<br>Animation.RELATIVE_TO_SELF、Animation.RELATIVE_TO_PARENT</p>
</blockquote>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;scale xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXScale=&quot;0.0&quot;</div><div class="line">    android:toXScale=&quot;1.4&quot;</div><div class="line">    android:fromYScale=&quot;0.0&quot;</div><div class="line">    android:toYScale=&quot;1.4&quot;</div><div class="line">    android:pivotX=&quot;50%&quot;</div><div class="line">    android:pivotY=&quot;50%&quot;</div><div class="line">    android:duration=&quot;700&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>对应代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ScaleAnimation scaleAnim = new ScaleAnimation(0.0f, 1.4f, 0.0f, 1.4f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line">scaleAnim.setDuration(700);</div><div class="line">tv.startAnimation(scaleAnim);</div></pre></td></tr></table></figure></p>
<h4 id="2-2-3-AlphaAnimation"><a href="#2-2-3-AlphaAnimation" class="headerlink" title="2.2.3 AlphaAnimation"></a>2.2.3 AlphaAnimation</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">AlphaAnimation(float fromAlpha, float toAlpha)</div></pre></td></tr></table></figure>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;alpha xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromAlpha=&quot;1.0&quot;</div><div class="line">    android:toAlpha=&quot;0.1&quot;</div><div class="line">    android:fillBefore=&quot;true&quot;</div><div class="line">    android:duration=&quot;3000&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>对应代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">AlphaAnimation alphaAnim = new AlphaAnimation(1.0f, 0.1f);</div><div class="line">alphaAnim.setDuration(3000);</div><div class="line">alphaAnim.setFillBefore(true);</div></pre></td></tr></table></figure></p>
<h4 id="2-2-4-RotateAnimation"><a href="#2-2-4-RotateAnimation" class="headerlink" title="2.2.4 RotateAnimation"></a>2.2.4 RotateAnimation</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">RotateAnimation(float fromDegrees, float toDegrees)</div><div class="line">RotateAnimation(float fromDegrees, float toDegrees, float pivotX, float pivotY)</div><div class="line">RotateAnimation(float fromDegrees, float toDegrees, </div><div class="line">                int pivotXType, float pivotXValue, </div><div class="line">                int pivotYType, float pivotYValue)</div></pre></td></tr></table></figure>
<blockquote>
<p>pivotXType 取值为：<br>Animation.ABSOLUTE、<br>Animation.RELATIVE_TO_SELF、Animation.RELATIVE_TO_PARENT</p>
</blockquote>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;rotate xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromDegrees=&quot;0&quot;</div><div class="line">    android:toDegrees=&quot;-650&quot;</div><div class="line">    android:pivotX=&quot;50%&quot;</div><div class="line">    android:pivotY=&quot;50%&quot;</div><div class="line">    android:duration=&quot;3000&quot;</div><div class="line">    android:fillAfter=&quot;true&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>对应代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">RotateAnimation alphaAnim = new RotateAnimation(0, -650, </div><div class="line">                Animation.RELATIVE_TO_SELF, 0.5f, </div><div class="line">                Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line">alphaAnim.setDuration(3000);</div><div class="line">alphaAnim.setFillAfter(true);</div></pre></td></tr></table></figure></p>
<h4 id="2-2-5-TranslateAnimation"><a href="#2-2-5-TranslateAnimation" class="headerlink" title="2.2.5 TranslateAnimation"></a>2.2.5 TranslateAnimation</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">TranslateAnimation(float fromXDelta,  float toXDelta, </div><div class="line">                   float fromYDelta, float toYDelta)</div><div class="line">TranslateAnimation(int fromXType, float fromXValue, </div><div class="line">                   int toXType, float toXValue,</div><div class="line">                   int fromYType, float fromYValue, </div><div class="line">                   int toYType, float toYValue)</div></pre></td></tr></table></figure>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;translate xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXDelta=&quot;0&quot;</div><div class="line">    android:toXDelta=&quot;-80&quot;</div><div class="line">    android:fromYDelta=&quot;0&quot;</div><div class="line">    android:toYDelta=&quot;-80&quot;</div><div class="line">    android:duration=&quot;2000&quot;</div><div class="line">    android:fillBefore=&quot;true&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>对应代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">TranslateAnimation alphaAnim = new TranslateAnimation(</div><div class="line">        Animation.ABSOLUTE, 0, Animation.ABSOLUTE, -80, </div><div class="line">        Animation.ABSOLUTE, 0, Animation.ABSOLUTE, -80);</div><div class="line">alphaAnim.setDuration(2000);</div><div class="line">alphaAnim.setFillBefore(true);</div></pre></td></tr></table></figure></p>
<h4 id="2-2-6-AnimationSet"><a href="#2-2-6-AnimationSet" class="headerlink" title="2.2.6 AnimationSet"></a>2.2.6 AnimationSet</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">AnimationSet(boolean shareInterpolator)</div></pre></td></tr></table></figure>
<p>shareInterpolator 参数取值为 true 时，用于 AnimationSet 类中定义一个插值器，其下面的所有动画共用该插值器；取值为 false，则表示其下面的动画定义各自的插值器。增加动画的函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public void addAnimation(Animation a)</div></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;set xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:duration=&quot;2000&quot;</div><div class="line">    android:fillAfter=&quot;true&quot;&gt;</div><div class="line">    &lt;alpha</div><div class="line">        android:fromAlpha=&quot;0.0&quot;</div><div class="line">        android:toAlpha=&quot;1.0&quot;/&gt;</div><div class="line">    &lt;scale</div><div class="line">        android:fromXScale=&quot;0.0&quot;</div><div class="line">        android:toXScale=&quot;1.4&quot;</div><div class="line">        android:fromYScale=&quot;0.0&quot;</div><div class="line">        android:toYScale=&quot;1.4&quot;</div><div class="line">        android:pivotX=&quot;50%&quot;</div><div class="line">        android:pivotY=&quot;50%&quot; /&gt;</div><div class="line">    &lt;rotate</div><div class="line">        android:fromDegrees=&quot;0&quot;</div><div class="line">        android:toDegrees=&quot;720&quot;</div><div class="line">        android:pivotX=&quot;50%&quot;</div><div class="line">        android:pivotY=&quot;50%&quot;/&gt;</div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure></p>
<p>对应代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Animation alphaAnim = new AlphaAnimation(0, 1.0f);</div><div class="line">Animation scaleAnim = new ScaleAnimation(0, 1.4f, 0, 1.4f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line">Animation rotateAnim = new RotateAnimation(0, 720, Animation.RELATIVE_TO_SELF, </div><div class="line">        0.5f, Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line"></div><div class="line">AnimationSet setAnim = new AnimationSet(true);</div><div class="line">setAnim.addAnimation(alphaAnim);</div><div class="line">setAnim.addAnimation(scaleAnim);</div><div class="line">setAnim.addAnimation(rotateAnim);</div><div class="line"></div><div class="line">setAnim.setDuration(3000);</div><div class="line">setAnim.setFillAfter(true);</div><div class="line"></div><div class="line">view.startAnimation(setAnim);</div></pre></td></tr></table></figure></p>
<h4 id="2-2-7-Animation"><a href="#2-2-7-Animation" class="headerlink" title="2.2.7 Animation"></a>2.2.7 Animation</h4><p>Animation 还有一些比较实用的方法介绍，如下：<br>| 方法 | 说明 |<br>| :—–: | —–: |<br>| cancel() | 取消动画 |<br>| reset() | 将控件重置到动画开始前状态 |<br>| hasStarted() | 判断当前 Animation 是否开始 |<br>| hasEnded() | 判断当前 Animation 是否结束 |<br>| setAnimationListener() | 设置动画监听 |</p>
<p>Animation.AnimationListener：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public static interface AnimationListener &#123;</div><div class="line">    // 动画开始时调用</div><div class="line">    void onAnimationStart(Animation animation);</div><div class="line">    // 动画结束时调用</div><div class="line">    void onAnimationEnd(Animation animation);</div><div class="line">    // 动画重复时调用</div><div class="line">    void onAnimationRepeat(Animation animation);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">final RotateAnimation rotateAnim = new RotateAnimation(0, 720, </div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line">rotateAnim.setDuration(2000);</div><div class="line">rotateAnim.setFillAfter(true);</div><div class="line"></div><div class="line">ScaleAnimation scaleAnim = new ScaleAnimation(0, 1.4f, 0, 1.4f,</div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f, </div><div class="line">        Animation.RELATIVE_TO_SELF, 0.5f);</div><div class="line">scaleAnim.setDuration(700);</div><div class="line">scaleAnim.setAnimationListener(new Animation.AnimationListener() &#123;</div><div class="line">    @Override</div><div class="line">    public void onAnimationStart(Animation animation) &#123;&#125;</div><div class="line">    @Override</div><div class="line">    public void onAnimationEnd(Animation animation) &#123;</div><div class="line">        view.startAnimation(rotateAnim);</div><div class="line">    &#125;</div><div class="line">    @Override</div><div class="line">    public void onAnimationRepeat(Animation animation) &#123; &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">view.startAnimation(scaleAnim);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-1f482e16cf4cbca6.gif?imageMogr2/auto-orient/strip" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/02/Custom View/02.1 精通自定义 View 之视图动画（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/02/Custom View/02.1 精通自定义 View 之视图动画（一）/" itemprop="url">02.1 精通自定义 View 之视图动画（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-02T07:24:00+08:00">
                2019-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="2-1-视图动画标签"><a href="#2-1-视图动画标签" class="headerlink" title="2.1 视图动画标签"></a>2.1 视图动画标签</h2><p>Animation：</p>
<ul>
<li>View Animation（视图动画，API Level 1）<br>|—- Tween Animation（补间动画）<br>|—- Frame Animation（逐帧动画）</li>
<li>Property Animation（属性动画，API Level 11）<br>|—- ValueAnimator<br>|—- ObjectAnimator</li>
</ul>
<h4 id="2-1-1-概述"><a href="#2-1-1-概述" class="headerlink" title="2.1.1 概述"></a>2.1.1 概述</h4><p>视图动画分为 5 种类型组成：<br>scale：渐变透明度动画效果<br>alpha：渐变尺寸伸缩动画效果<br>rotate：画面转移旋转动画效果<br>translate：画面变化位置移动动画效果<br>set：定义动画集</p>
<h6 id="1-配置-XML-动画文件"><a href="#1-配置-XML-动画文件" class="headerlink" title="1. 配置 XML 动画文件"></a>1. 配置 XML 动画文件</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;&gt;</div><div class="line">&lt;scale xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXScale=&quot;0.0&quot;</div><div class="line">    android:toXScale=&quot;1.4&quot;</div><div class="line">    android:fromYScale=&quot;0.0&quot;</div><div class="line">    android:toYScale=&quot;1.4&quot;</div><div class="line">    android:duration=&quot;700&quot;</div></pre></td></tr></table></figure>
<h6 id="2-动画文件存放位置"><a href="#2-动画文件存放位置" class="headerlink" title="2. 动画文件存放位置"></a>2. 动画文件存放位置</h6><p>存放在 res/anim 文件夹下，访问时使用 R.anim.XXX。<br>存放在 res/drawable 文件夹下，访问时使用 R.drawable.XXX。</p>
<h6 id="3-使用动画文件"><a href="#3-使用动画文件" class="headerlink" title="3. 使用动画文件"></a>3. 使用动画文件</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">View view = findViewById(R.id.view);</div><div class="line">Animation animation = AnimationUtils.loadAnimation(this, R.anim.scale_anim);</div><div class="line">view.startAnimation(animation);</div></pre></td></tr></table></figure>
<h4 id="2-1-2-scale-标签"><a href="#2-1-2-scale-标签" class="headerlink" title="2.1.2 scale 标签"></a>2.1.2 scale 标签</h4><p>scale 标签用于缩放动画，可以实现动态调整控件尺寸的效果：</p>
<ul>
<li>android:fromXScale：动画开始时，控件在 X 轴方向上相对自身的缩放比例，浮点值。1.0 代表自身无变化，0.5 表示缩小一倍，2.0 代表放大一倍。</li>
<li>android:toXScale：动画结束时，控件在 X 轴方向上相对自身的缩放比例，浮点值。</li>
<li>android:fromYScale：动画开始时，控件在 Y 轴方向上相对自身的缩放比例，浮点值。</li>
<li>android:toYScale：动画结束时，控件在 Y 轴方向上相对自身的缩放比例，浮点值。</li>
<li>android:pivotX：缩放起始点 X 轴坐标。是数值如 50，则表示在当前控件的左上角原点 X 轴坐标 + 50px，作为缩放起始点 X 轴坐标；是百分数如 50%，则表示在当前控件的左上角原点 X 轴坐标 + 自身宽度的 50%，作为缩放起始点 X 轴坐标；是百分数 p 如 50%p，则表示在当前控件的左上角原点 X 轴坐标 + 父控件宽度的 50%，作为缩放起始点 X 轴坐标；</li>
<li>android:pivotY：缩放起始点 Y 轴坐标。取值同上。</li>
</ul>
<p>示例：<br>缩放动画 scale1.xml：android:pivotX=”50”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;scale xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXScale=&quot;0.0&quot;</div><div class="line">    android:toXScale=&quot;1.0&quot;</div><div class="line">    android:fromYScale=&quot;0.0&quot;</div><div class="line">    android:toYScale=&quot;1.0&quot;</div><div class="line">    android:pivotX=&quot;50&quot;</div><div class="line">    android:duration=&quot;700&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>缩放动画 scale2.xml：android:pivotX=”50%”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;scale xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXScale=&quot;0.0&quot;</div><div class="line">    android:toXScale=&quot;1.0&quot;</div><div class="line">    android:fromYScale=&quot;0.0&quot;</div><div class="line">    android:toYScale=&quot;1.0&quot;</div><div class="line">    android:pivotX=&quot;50%&quot;</div><div class="line">    android:duration=&quot;700&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>缩放动画 scale3.xml：android:pivotX=”50%”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;scale xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXScale=&quot;0.0&quot;</div><div class="line">    android:toXScale=&quot;1.0&quot;</div><div class="line">    android:fromYScale=&quot;0.0&quot;</div><div class="line">    android:toYScale=&quot;1.0&quot;</div><div class="line">    android:pivotX=&quot;50%p&quot;</div><div class="line">    android:duration=&quot;700&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-7756d7b6da97fa09.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-1-3-Animation-继承属性"><a href="#2-1-3-Animation-继承属性" class="headerlink" title="2.1.3 Animation 继承属性"></a>2.1.3 Animation 继承属性</h4><p>所有的动画都继承自 Animation 类，它的内部实现了一些共用的动画属性：</p>
<ul>
<li>android:duration：一次动画的持续时间，单位毫秒。</li>
<li>android:fillAfter：为 true 表示控件动画结束时，将保持动画结束时的状态。</li>
<li>android:fillBefore：为 true 表示控件动画结束时，将还原到初始化状态。默认为 true。</li>
<li>android:fillEnabled：同 fillBefore。</li>
<li>android:repeatCount：指定动画的重复次数，取值为 infinite 时，表示无限循环。</li>
<li>android:repeatMode：设定重复的类型，有 reverse（倒序回放） 和 restart（重放） 两个值。与 repeatCount 一起使用才有效果。</li>
<li>android:interpolator：设定插值器，指定动画效果，比如弹跳效果。</li>
</ul>
<h4 id="2-1-4-alpha-标签"><a href="#2-1-4-alpha-标签" class="headerlink" title="2.1.4 alpha 标签"></a>2.1.4 alpha 标签</h4><p>alpha 标签用于实现渐变透明度动画效果。除从 Animation 类继承而来的属性外，自身所具有的属性如下：</p>
<ul>
<li>android:fromAlpha：动画开始的透明度，取值范围 0.0 ~ 1.0，0.0 表示完全透明，1.0 表示完全不透明。</li>
<li>android:toAlpha：动画结束的透明度，取值范围 0.0 ~ 1.0，0.0 表示完全透明，1.0 表示完全不透明。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;alpha xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromAlpha=&quot;1.0&quot;</div><div class="line">    android:toAlpha=&quot;0.5&quot;</div><div class="line">    android:repeatMode=&quot;reverse&quot;</div><div class="line">    android:repeatCount=&quot;infinite&quot;</div><div class="line">    android:duration=&quot;700&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-584dead53190f9d3.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-1-5-rotate-标签"><a href="#2-1-5-rotate-标签" class="headerlink" title="2.1.5 rotate 标签"></a>2.1.5 rotate 标签</h4><p>rotate 标签用于实现画面转移旋转动画效果。除从 Animation 类继承而来的属性外，自身所具有的属性如下：</p>
<ul>
<li>android:fromDegrees：动画开始旋转时的角度位置，正值代表顺时针方向的度数，负值代表逆时针方向的度数。</li>
<li>android:toDegrees：动画结束时旋转到的角度位置，正值代表顺时针方向的度数，负值代表逆时针方向的度数。</li>
<li>android:pivotX：旋转中心点 X 轴坐标，默认旋转中心点为控件的坐标原点（左上角），可以是数值、百分数、百分数p 三种样式。</li>
<li>android:pivotY：旋转中心点 Y 轴坐标，同上。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;rotate xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromDegrees=&quot;0&quot;</div><div class="line">    android:toDegrees=&quot;180&quot;</div><div class="line">    android:pivotX=&quot;50%&quot;</div><div class="line">    android:pivotY=&quot;50%&quot;</div><div class="line">    android:repeatMode=&quot;restart&quot;</div><div class="line">    android:repeatCount=&quot;infinite&quot;</div><div class="line">    android:duration=&quot;700&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-dba6e63da35e2b0a.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-1-6-translate-标签"><a href="#2-1-6-translate-标签" class="headerlink" title="2.1.6 translate 标签"></a>2.1.6 translate 标签</h4><p>translate 标签用于实现画面转移旋转动画效果。除从 Animation 类继承而来的属性外，自身所具有的属性如下：</p>
<ul>
<li>android:fromXDelta：起始点 X 轴坐标，可以是数值、百分数、百分数p。</li>
<li>android:fromYDelta：起始点 Y 轴坐标，同上。</li>
<li>android:toXDelta：终点 X 轴坐标。</li>
<li>android:toYDelta：终点 Y 轴坐标。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;translate xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:fromXDelta=&quot;0&quot;</div><div class="line">    android:fromYDelta=&quot;0&quot;</div><div class="line">    android:toXDelta=&quot;-50%&quot;</div><div class="line">    android:toYDelta=&quot;-50%&quot;</div><div class="line">    android:duration=&quot;1500&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-a869cc5df2429999.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h4 id="2-1-7-set-标签"><a href="#2-1-7-set-标签" class="headerlink" title="2.1.7 set 标签"></a>2.1.7 set 标签</h4><p>set 标签是一个容器类标签，用于定义动画集。前面的 4 个标签只能完成特定的功能，而 set 标签则可以把这些动画效果组合起来，共同完成一个动画。set 标签自身没有属性，它的属性都是从 Animation 类继承而来的。当这些属性用于 set 标签时，就会对 set 标签下的所有子控件产生作用。但 repeateCount 属性是无效的，必须对每个动画单独设置才有作用。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;set xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    android:duration=&quot;2000&quot;</div><div class="line">    android:fillAfter=&quot;true&quot;&gt;</div><div class="line">    &lt;alpha</div><div class="line">        android:fromAlpha=&quot;0.0&quot;</div><div class="line">        android:toAlpha=&quot;1.0&quot;/&gt;</div><div class="line">    &lt;scale</div><div class="line">        android:fromXScale=&quot;0.0&quot;</div><div class="line">        android:toXScale=&quot;1.4&quot;</div><div class="line">        android:fromYScale=&quot;0.0&quot;</div><div class="line">        android:toYScale=&quot;1.4&quot;</div><div class="line">        android:pivotX=&quot;50%&quot;</div><div class="line">        android:pivotY=&quot;50%&quot; /&gt;</div><div class="line">    &lt;rotate</div><div class="line">        android:fromDegrees=&quot;0&quot;</div><div class="line">        android:toDegrees=&quot;720&quot;</div><div class="line">        android:pivotX=&quot;50%&quot;</div><div class="line">        android:pivotY=&quot;50%&quot;/&gt;</div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-bf4c19f3e714f6c4.gif?imageMogr2/auto-orient/strip" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/Custom View/01.6 精通自定义 View 之绘图基础（六）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/01/Custom View/01.6 精通自定义 View 之绘图基础（六）/" itemprop="url">01.6 精通自定义 View 之绘图基础（六）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-01T22:09:00+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="1-6-控件的使用方法"><a href="#1-6-控件的使用方法" class="headerlink" title="1.6 控件的使用方法"></a>1.6 控件的使用方法</h2><h4 id="1-6-1-控件概述"><a href="#1-6-1-控件概述" class="headerlink" title="1.6.1 控件概述"></a>1.6.1 控件概述</h4><p>在自定义一个派生自 View 或 ViewGroup 类的控件时，必须实现一个构造函数。有三个构造函数供我们选择。<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class CustomView extends View &#123;</div><div class="line">    public CustomView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">    &#125;</div><div class="line">    public CustomView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">    &#125;</div><div class="line">    public CustomView(Context context, AttributeSet attrs, int defStyle) &#123; </div><div class="line">        super(context, attrs, defStyle);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其实每种构造函数都是在特定的使用情景下所必须实现的，否则将会报 inflate 错误。</p>
<h4 id="1-6-2-通过XML引入控件"><a href="#1-6-2-通过XML引入控件" class="headerlink" title="1.6.2 通过XML引入控件"></a>1.6.2 通过XML引入控件</h4><p>使用以下方式引入控件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;LinearLayout ...&gt;</div><div class="line">    &lt;com.xxt.xtest.CustomView ... /&gt;</div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure></p>
<p>就必须实现第二个构造函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public CustomView(Context context, AttributeSet attrs) &#123;</div><div class="line">    super(context, attrs);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="1-6-3-动态添加控件"><a href="#1-6-3-动态添加控件" class="headerlink" title="1.6.3 动态添加控件"></a>1.6.3 动态添加控件</h4><h6 id="1-概述"><a href="#1-概述" class="headerlink" title="1. 概述"></a>1. 概述</h6><p>示例如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">LinearLayout rootView = (LinearLayout)findViewById(R.id.root);</div><div class="line">CustomView customView = new CustomView(this);</div><div class="line">LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams (</div><div class="line">                LinearLayout.LayoutParams.MATCH_PARENT, </div><div class="line">                LinearLayout.LayoutParams.MATCH_PARENT);</div><div class="line">rootView.addView(customView,layoutParams);</div></pre></td></tr></table></figure></p>
<h6 id="2-LayoutParams"><a href="#2-LayoutParams" class="headerlink" title="2. LayoutParams"></a>2. LayoutParams</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 第一个构造函数常用</div><div class="line">public LayoutParams(int width, int height)</div><div class="line">// 用于从 AttributeSet 中􏰑取出 layout_width、 layout_height 等各属性的值</div><div class="line">public LayoutParams(Context c, AttributeSet attrs)</div><div class="line">public LayoutParams(LayoutParams source)</div></pre></td></tr></table></figure>
<p>每个容器类控件都会实现一套 LayoutParams 类，而子类则用的是父容器的 LayoutParams 类。比如上述中父容器是 LinearLayout，所以使用 LinearLayout.LayoutParams。之所以不能共用，是因为各个容器所对应的布局属性是不一样的。</p>
<p>在 RelativeLayout 中，实现添加到 TextView 控件的右侧：addRule()<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">RelativeLayout rootView = (RelativeLayout) findViewById(R.id.root); </div><div class="line">CustomView customView = new CustomView(this);</div><div class="line">RelativeLayout.LayoutParams layoutParams = new RelativeLayout.LayoutParams(</div><div class="line">                RelativeLayout.LayoutParams.MATCH_PARENT, </div><div class="line">                RelativeLayout.LayoutParams.MATCH_ PARENT);</div><div class="line">layoutParams.addRule(RelativeLayout.RIGHT_OF,R.id.text); </div><div class="line">rootView.addView(customView, layoutParams);</div></pre></td></tr></table></figure></p>
<p>1）设置 margin<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(</div><div class="line">                LinearLayout. LayoutParams.WRAP_CONTENT, </div><div class="line">                LinearLayout.LayoutParams.WRAP_CONTENT);</div><div class="line">lp.setMargins(10, 20, 30, 40);</div><div class="line">imageView.setLayoutParams(lp);</div></pre></td></tr></table></figure></p>
<p>2）设置 layout_weight (方法一)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">TextView tv_like = new TextView(this);</div><div class="line">LinearLayout.LayoutParams LP_LIKE_MW = new LinearLayout.LayoutParams (</div><div class="line">                LinearLayout.LayoutParams.MATCH_PARENT, </div><div class="line">                LinearLayout.LayoutParams.WRAP_ CONTENT, </div><div class="line">                1.0f);</div><div class="line">tv_like.setText(&quot;赞(8)&quot;); </div><div class="line">tv_like.setTextSize(16); </div><div class="line">layout_sub_Lin.addView(tv_like, LP_LIKE_MW);</div></pre></td></tr></table></figure></p>
<p>3）设置 layout_weight (方法二)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(</div><div class="line">                LinearLayout.LayoutParams.MATCH_PARENT,</div><div class="line">                LinearLayout.LayoutParams.MATCH_ PARENT);</div><div class="line">layoutParams.weight = 1.0f;</div><div class="line">rootView.addView(customView, layoutParams);</div></pre></td></tr></table></figure></p>
<p>4）设置 layout_gravity<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(</div><div class="line">                LinearLayout.LayoutParams.MATCH_PARENT,</div><div class="line">                LinearLayout.LayoutParams.MATCH_ PARENT);</div><div class="line">params.gravity = Gravity.TOP;</div><div class="line">Button button = new Button(this);</div><div class="line">rootView.addView(button, layoutParams);</div></pre></td></tr></table></figure></p>
<p>5）设置 android:gravity<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">RelativeLayout rootView = (RelativeLayout) findViewById(R.id.root);</div><div class="line">RelativeLayout.LayoutParams layoutParams = new RelativeLayout.LayoutParams(</div><div class="line">                RelativeLayout.LayoutParams.WRAP_CONTENT,</div><div class="line">                200);</div><div class="line">layoutParams.addRule(RelativeLayout.RIGHT_OF, R.id.text);</div><div class="line"></div><div class="line">Button button = new Button(this); </div><div class="line">button.setGravity(Gravity.TOP);</div><div class="line">button.setText(&quot;btn&quot;);</div><div class="line">rootView.addView(button, layoutParams); </div><div class="line">rootView.setGravity(Gravity.TOP | Gravity.CENTER_HORIZONTAL);</div></pre></td></tr></table></figure></p>
<h6 id="3-addView"><a href="#3-addView" class="headerlink" title="3. addView"></a>3. addView</h6><p>动态添加控件都是通过 addView 来实现的，addView 是 ViewGroup 类中的一个函数，它有 5 个构造函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// 在节点末尾添加一个 View 控件，布局使用默认布局</div><div class="line">// layout_width = wrap_content、layout_height = wrap_content</div><div class="line">public void addView(View child)</div><div class="line"></div><div class="line">// 在指定位置添加一个 View 控件，index 的取值有-1、0 和正数。</div><div class="line">// -1：表示在末尾添加一个 View 控件</div><div class="line">// 0：表示在容器顶端添加一个 View 控件</div><div class="line">// 正数：表示在对应的索引位置插入一个 View 控件</div><div class="line">public void addView(View child, int index)</div><div class="line"></div><div class="line">// 使用自定义自定义布局参数，在节点末尾添加一个 View 控件</div><div class="line">public void addView(View child, LayoutParams params)</div><div class="line"></div><div class="line">// 使用自定义自定义布局参数，在指定位置添加一个 View 控件</div><div class="line">public void addView(View child, int index, LayoutParams params)</div><div class="line"></div><div class="line">// 只指定宽和高</div><div class="line">public void addView(View child, int width, int height)</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/Custom View/01.5 精通自定义 View 之绘图基础（五）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/01/Custom View/01.5 精通自定义 View 之绘图基础（五）/" itemprop="url">01.5 精通自定义 View 之绘图基础（五）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-01T17:54:00+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="1-5-Canvas-画布"><a href="#1-5-Canvas-画布" class="headerlink" title="1.5 Canvas(画布)"></a>1.5 Canvas(画布)</h2><h4 id="1-5-1-Canvas变换"><a href="#1-5-1-Canvas变换" class="headerlink" title="1.5.1 Canvas变换"></a>1.5.1 Canvas变换</h4><h6 id="1-平移-Translate"><a href="#1-平移-Translate" class="headerlink" title="1.平移(Translate)"></a>1.平移(Translate)</h6><p>画布的原始状态是以左上角为原点，向右是X轴正方向，向下是Y轴正方向。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void translate(float dx, float dy)</div></pre></td></tr></table></figure></p>
<p>参数:<br>float dx：水平方向平移的距离，正数为向正方向(向右)平移的量，负数为向负方向 (向左)平移的量。<br>float dy：垂直方向平移的距离，正数为向正方向(向下)平移的量，负数为向负方向 (向上)平移的量。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">paintGreen = generatePaint(Color.GREEN, Paint.Style.STROKE, 3);</div><div class="line">paintRed = generatePaint(Color.RED, Paint.Style.STROKE, 3);</div><div class="line">rect = new Rect(20,20,400,220);</div><div class="line"></div><div class="line">canvas.drawRect(rect, paintGreen);</div><div class="line">// 画布平移</div><div class="line">canvas.translate(100, 100);</div><div class="line">canvas.drawRect(rect, paintRed);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-0c93c2d9c06d16a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>上述示例中，调用 canvas.translate(100, 100) 后，绿色矩形区域并没有随着画布移动。这是由于屏幕显示与 Canvas 根本不是一个概念！</p>
</blockquote>
<h6 id="2-屏幕显示与-Canvas-的关系"><a href="#2-屏幕显示与-Canvas-的关系" class="headerlink" title="2.屏幕显示与 Canvas 的关系"></a>2.屏幕显示与 Canvas 的关系</h6><p>Canvas 是一个很虚幻的概念，相当于一个透明图层。每次在 Canvas 上画图时(调用 drawXXX 系列函数)，都会先产生一个透明图层，然后在这个图层上画图，画完之后覆盖在屏幕上显示。所以，上述结果是经以下几个步骤形成的:<br>(1) 在调用 canvas.drawRect(rect1, paint_green) 时，产生一个 Canvas 透明图层，由于当时还没有对坐标系进行平移，所以坐标原点是(0,0)；在 Canvas 上画好之后，覆盖到屏幕上显示出来。过程如下图所示。<br><img src="https://upload-images.jianshu.io/upload_images/14186083-c891c073af2f3bd3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>(2) 在调用 canvas.drawRect(rect1, paint_red) 时，又会产生一个全新的 Canvas 透明图层，但此时画布坐标已经改变了，即分别向右和向下移动了 100 像素，所以此时的绘图方式如下图所示(合成视图，从上往下看的合成方式)。<br><img src="https://upload-images.jianshu.io/upload_images/14186083-21c34d62a6ad5d70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>总结：</p>
<ul>
<li>当每次调用 drawXXX 系列函数来绘图时，都会产生一个全新的 Canvas 透明图层。</li>
<li>如果在调用 drawXXX 系列函数前，调用平移、旋转等函数对 Canvas 进行了操作，那么这个操作是不可逆的。每次产生的画布的最新位置都是这些操作后的位置。</li>
<li>在 Canvas 图层与屏幕合成时，超出屏幕范围的图像是不会显示出来的。</li>
</ul>
<h6 id="3-旋转-Rotate"><a href="#3-旋转-Rotate" class="headerlink" title="3.旋转(Rotate)"></a>3.旋转(Rotate)</h6><p>画布的旋转默认是围绕坐标原点来进行的。这里容易产生错觉，看起来是图片旋转了，其实我们旋转的是画布，以后在此画布上绘制的图形显示出来的时候看起来都是旋转的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">void rotate(float degrees)</div><div class="line">void rotate(float degrees, float px, float py)</div></pre></td></tr></table></figure></p>
<p>参数：</p>
<ul>
<li>float degrees：旋转的度数，正数指顺时针旋转。旋转中心点是(0,0)。</li>
<li>float px, py：指定旋转的中心点坐标(px,py)。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public TestView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">    super(context, attrs);</div><div class="line">    mPaint = new Paint();</div><div class="line">    mPaint.setColor(Color.BLUE);</div><div class="line">    mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">    mRect = new RectF(300,50,500,150);</div><div class="line">&#125;</div><div class="line">@Override</div><div class="line">protected void onDraw(Canvas canvas) &#123;</div><div class="line">    canvas.drawRect(mRect, mPaint);</div><div class="line">    mPaint.setColor(Color.RED);</div><div class="line">    mPaint.setStyle(Paint.Style.FILL);</div><div class="line">    canvas.rotate(30);</div><div class="line">    canvas.drawRect(mRect, mPaint);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-b8a43538eb565d32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="旋转"></p>
<p>旋转原理：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-0763f5275574be3e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第一次合成：canvas.drawRect(mRect, mPaint)"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-7605273e69198649.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="4-缩放-Scale"><a href="#4-缩放-Scale" class="headerlink" title="4.缩放(Scale)"></a>4.缩放(Scale)</h6><p>变更坐标轴密度。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public void scale(float sx, float sy)</div></pre></td></tr></table></figure></p>
<p>参数:<br>float sx：水平方向伸缩的比例。小数表示缩小，整数表示放大。<br>float sy：垂直方向伸缩的比例。小数表示缩小，整数表示放大。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mPaintBlue  = generatePaint(Color.BLUE, Paint.Style.STROKE, 5);</div><div class="line">mPaintRed = generatePaint(Color.RED, Paint.Style.STROKE, 5);</div><div class="line">mRect = new RectF(100,50,500,150);</div><div class="line"></div><div class="line">canvas.drawRect(mRect, mPaintBlue);</div><div class="line">canvas.scale(0.5f, 1);</div><div class="line">canvas.drawRect(mRect, mPaintRed);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-b57178b81b5327a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>蓝框是原坐标轴密度图形,红框是 X 轴密度缩小到 0.5 倍之后显示的图形。</p>
<h6 id="5-扭曲-Skew"><a href="#5-扭曲-Skew" class="headerlink" title="5.扭曲(Skew)"></a>5.扭曲(Skew)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void skew(float sx, float sy)</div></pre></td></tr></table></figure>
<p>参数：<br>float sx：将画布在 X 轴方向上倾斜相应的角度，sx 为倾斜角度的正切值。<br>float sy：将画布在 Y 轴方向上倾斜相应的角度，sy 为倾斜角度的正切值。</p>
<blockquote>
<p>注意：这里都是倾斜角度的正切值。比如，在 X 轴方向上倾斜 60°，tan60=1.732。</p>
</blockquote>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mRect = new RectF(100,100,300,300);</div><div class="line"></div><div class="line">canvas.drawRect(mRect, mPaintBlue);</div><div class="line">canvas.skew(0.5f, 0.5f);</div><div class="line">canvas.drawRect(mRect, mPaintRed);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-946974bf21dd5cb2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="6-裁剪画布-clip-系列函数"><a href="#6-裁剪画布-clip-系列函数" class="headerlink" title="6.裁剪画布(clip 系列函数)"></a>6.裁剪画布(clip 系列函数)</h6><p>裁剪画布是指利用 clip 系列函数，通过与 Rect、Path、Region 取交、并、差等集合运算来获得最新的画布形状。除调用 save()、restore()函数以外，这个操作是不可逆的，一旦 Canvas 被裁剪，就不能恢复。</p>
<blockquote>
<p>在使用裁剪画布系列函数时，需要禁用硬件加速功能。<br>setLayerType(LAYER_TYPE_SOFTWARE, null);</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">boolean clipPath(Path path)</div><div class="line">boolean clipPath(Path path, Region.Op op)</div><div class="line"></div><div class="line">boolean clipRect(RectF rect)</div><div class="line">boolean clipRect(Rect rect)</div><div class="line">boolean clipRect(Rect rect, Region.Op op)</div><div class="line">boolean clipRect(RectF rect, Region.Op op)</div><div class="line">boolean clipRect(int left, int top, int right, int bottom)</div><div class="line">boolean clipRect(float left, float top, float right, float bottom)</div><div class="line">boolean clipRect(float left, float top, float right, float bottom, </div><div class="line">                 Region.Op op) </div><div class="line"></div><div class="line">boolean clipRegion(Region region)</div><div class="line">boolean clipRegion(Region region, Region.Op op)</div></pre></td></tr></table></figure>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">canvas.drawColor(Color.RED);</div><div class="line">canvas.clipRect(new Rect(100, 100, 200, 200));</div><div class="line">canvas.drawColor(Color.GREEN);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-289bb5e9e5ff331a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>先把背景色涂成红色，显示在屏幕上，然后裁剪画布，最后将最新的画布涂成绿色。可见，绿色部分只有一小块，而不再是整个屏幕。</p>
<h4 id="1-5-2-画布的保存与恢复"><a href="#1-5-2-画布的保存与恢复" class="headerlink" title="1.5.2 画布的保存与恢复"></a>1.5.2 画布的保存与恢复</h4><h6 id="1-save-和-restore-函数"><a href="#1-save-和-restore-函数" class="headerlink" title="1. save()和 restore()函数"></a>1. save()和 restore()函数</h6><p>前面介绍的所有对画布的操作都是不可逆的，如果要对画布的大小和状态(旋转角度、扭曲等)进行实时保存和恢复，需要借助save()和 restore() 这两个函数。</p>
<p>save() ：每次调用，都会先保存当前画布的状态，然后将其放入特定的栈中。<br>restore() ：每次调用，都会把栈中顶层的画布状态取出来，并按照这个状态恢复当前的画布，然后在这个画布上作画。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">canvas.drawColor(Color.RED);</div><div class="line">// 保存当前画布大小,即整屏 canvas.save();</div><div class="line">canvas.clipRect(new Rect(100, 100, 800, 800));</div><div class="line">canvas.drawColor(Color.GREEN);</div><div class="line">// 恢复整屏画布 canvas.restore();</div><div class="line">canvas.drawColor(Color.BLUE);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-55913d706eaf3164.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="2-restoreToCount-int-saveCount-函数"><a href="#2-restoreToCount-int-saveCount-函数" class="headerlink" title="2. restoreToCount(int saveCount)函数"></a>2. restoreToCount(int saveCount)函数</h6><p>我们可以多次调用 save()函数，但每次调用 restore()函数，只会将顶层的画布状态出栈。有时可能只需要用到特定的画布，这就需要多次 出栈。为了解决这个问题，Google 提供了另一个出栈函数 restoreToCount(int saveCount)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public int save();</div></pre></td></tr></table></figure></p>
<p>在利用 save()函数保存画布时，会有一个 int 类型的返回值。该返回值是当前所保存的画布所在栈的索引。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public void restoreToCount(int saveCount);</div></pre></td></tr></table></figure></p>
<p>而 restoreToCount()函数的用法就是一直出栈，直到指定索引的画布出栈为止，即将指定索引的画布作为当前画布。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">protected void onDraw(Canvas canvas) &#123;</div><div class="line">    super.onDraw(canvas);</div><div class="line">    canvas.drawColor(Color.RED); </div><div class="line">    // 保存的画布大小为全屏幕大小</div><div class="line">    int c1 = canvas.save();</div><div class="line">    canvas.clipRect(new Rect(100, 100, 800, 800));</div><div class="line">    canvas.drawColor(Color.GREEN); </div><div class="line">    // 保存的画布大小为Rect(100, 100, 800, 800)</div><div class="line">    int c2 = canvas.save();</div><div class="line"></div><div class="line">    canvas.clipRect(new Rect(200, 200, 700, 700));</div><div class="line">    canvas.drawColor(Color.BLUE); </div><div class="line">    // 保存的画布大小为Rect(200, 200, 700, 700)</div><div class="line">    int c3 = canvas.save();</div><div class="line"></div><div class="line">    canvas.clipRect(new Rect(300, 300, 600, 600));</div><div class="line">    canvas.drawColor(Color.BLACK); </div><div class="line">    // 保存的画布大小为Rect(300, 300, 600, 600)</div><div class="line">    int c4 = canvas.save();</div><div class="line"></div><div class="line">    canvas.clipRect(new Rect(400, 400, 500, 500));</div><div class="line">    canvas.drawColor(Color.WHITE);</div><div class="line"></div><div class="line"></div><div class="line">    // 连续三次出栈，将最后一次出栈的画布状态</div><div class="line">    // 作为当前画布，并填充为黄色 </div><div class="line">    // canvas.restore();</div><div class="line">    // canvas.restore();</div><div class="line">    // canvas.restore();</div><div class="line">    canvas.restoreToCount(c2); </div><div class="line">    canvas.drawColor(Color.YELLOW);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="1-5-3-示例一-圆形头像"><a href="#1-5-3-示例一-圆形头像" class="headerlink" title="1.5.3 示例一:圆形头像"></a>1.5.3 示例一:圆形头像</h4><p><img src="https://upload-images.jianshu.io/upload_images/14186083-e72dba62b99c9ddf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">public class TestView extends View &#123;</div><div class="line"></div><div class="line">    private Paint mPaint;</div><div class="line">    private Path mPath;</div><div class="line">    private Bitmap mBmp;</div><div class="line"></div><div class="line">    public TestView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void init() &#123;</div><div class="line">        // 禁用硬件加速</div><div class="line">        // setLayerType(LAYER_TYPE_SOFTWARE, null);</div><div class="line">        mPaint = new Paint();</div><div class="line">        mPath = new Path();</div><div class="line">        mBmp = BitmapFactory.decodeResource(getResources(), R.drawable.image);</div><div class="line">        int x = mBmp.getWidth() / 2;</div><div class="line">        int y = mBmp.getHeight() / 2;</div><div class="line">        int r = Math.min(x, y);</div><div class="line">        mPath.addCircle(x, y, r, Path.Direction.CCW);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line">        canvas.save();</div><div class="line">        canvas.clipPath(mPath);</div><div class="line">        canvas.drawBitmap(mBmp, 0, 0, mPaint);</div><div class="line">        canvas.restore();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>前面说过，在使用 clip 系列函数时，要禁用硬件加速功能。 setLayerType(LAYER_TYPE_SOFTWARE,null);<br>然而在手机型号 Pixel XL 上测试，是否禁用硬件加速功能并不影响 clip 函数。</p>
</blockquote>
<h4 id="1-5-4-示例二：裁剪动画"><a href="#1-5-4-示例二：裁剪动画" class="headerlink" title="1.5.4 示例二：裁剪动画"></a>1.5.4 示例二：裁剪动画</h4><p><img src="https://upload-images.jianshu.io/upload_images/14186083-31634c0bd9bd9969.gif?imageMogr2/auto-orient/strip" alt=""></p>
<h6 id="1-原理"><a href="#1-原理" class="headerlink" title="1. 原理"></a>1. 原理</h6><p>动画原理就是每次将裁剪区域变大，在裁剪区域内的图像就会显示出来，而裁剪区域之外的图像不会显示。而关键问题在于如何计算裁剪区域。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-a07fbe9ca6c6be10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这里很容易给大家造成错觉，以为黑色条是裁剪区域。其实不然，裁剪画布，在裁剪画布内的区域都是显示出来的，所以显示出来的区域才是裁剪区域。从图示中可以看出，有两个裁剪区域。</p>
<p>裁剪区域一：从左向右，逐渐变大。假设宽度是 clipWidth，高度是 CLIP_HEIGHT，那么裁剪区域一所对应的 Rect 对象如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Rect(0, 0, clipWidth, CLIP_HEIGHT);</div></pre></td></tr></table></figure></p>
<p>裁剪区域二：从右向左，同样逐渐变大，它的宽度、高度都与裁剪区域一相同。但它是从右向左变化的，假设图片的宽度是 width，那么裁剪区域二所对应的 Rect 对象如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Rect(width - clipWidth, CLIP_HEIGHT, width, 2* CLIP_HEIGHT);</div></pre></td></tr></table></figure></p>
<h6 id="2-示例代码"><a href="#2-示例代码" class="headerlink" title="2. 示例代码"></a>2. 示例代码</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">public class TestView extends View &#123;</div><div class="line"></div><div class="line">    private Paint mPaint;</div><div class="line">    private Bitmap mBitmap;</div><div class="line">    private int clipWidth = 0;</div><div class="line">    private int width;</div><div class="line">    private int height;</div><div class="line">    private static final int CLIP_HEIGHT = 30;</div><div class="line">    private Path mPath;</div><div class="line">    private RectF mRect;</div><div class="line"></div><div class="line">    public TestView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void init() &#123;</div><div class="line">        setLayerType(LAYER_TYPE_SOFTWARE, null);</div><div class="line">        mPaint = new Paint();</div><div class="line">        mBitmap = BitmapFactory.decodeResource(getResources(), R.drawable.bg);</div><div class="line">        width = mBitmap.getWidth();</div><div class="line">        height = mBitmap.getHeight();</div><div class="line">        mPath = new Path();</div><div class="line">        mRect = new RectF();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        mPath.reset();</div><div class="line">        int i = 0;</div><div class="line">        while (i * CLIP_HEIGHT &lt;= height) &#123;</div><div class="line">            if (i % 2 == 0) &#123;</div><div class="line">                mRect.set(0, i * CLIP_HEIGHT, clipWidth, (i+1) * CLIP_HEIGHT);</div><div class="line">            &#125; else &#123;</div><div class="line">                mRect.set(width - clipWidth, i * CLIP_HEIGHT, width, (i+1) * CLIP_HEIGHT);</div><div class="line">            &#125;</div><div class="line">            // 替换 Region.union 方法</div><div class="line">            mPath.addRect(mRect, Path.Direction.CCW);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        // 替换 canvas.clipRegion 方法</div><div class="line">        canvas.clipPath(mPath);</div><div class="line">        canvas.drawBitmap(mBitmap, 0, 0, mPaint);</div><div class="line">        if (clipWidth &gt; width) &#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        clipWidth += 5;</div><div class="line">        invalidate();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/Custom View/01.4 精通自定义 View 之绘图基础（四）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/01/Custom View/01.4 精通自定义 View 之绘图基础（四）/" itemprop="url">01.4 精通自定义 View 之绘图基础（四）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-01T15:11:00+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h2 id="1-4-Region"><a href="#1-4-Region" class="headerlink" title="1.4 Region"></a>1.4 Region</h2><h4 id="1-4-1-构造Region"><a href="#1-4-1-构造Region" class="headerlink" title="1.4.1 构造Region"></a>1.4.1 构造Region</h4><h6 id="1-直接构造"><a href="#1-直接构造" class="headerlink" title="1. 直接构造"></a>1. 直接构造</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 复制一个 Region 的范围，不常用</div><div class="line">public Region(Region region) </div><div class="line">// 创建一个矩形区域</div><div class="line">public Region(Rect r) </div><div class="line">// 创建一个矩形区域</div><div class="line">public Region(int left, int top, int right, int bottom)</div></pre></td></tr></table></figure>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Region region = new Region(new Rect(50,50,200,100));</div><div class="line">drawRegion(canvas,region,paint);</div><div class="line"></div><div class="line">private void drawRegion (Canvas canvas, Region rgn, Paint paint) &#123;</div><div class="line">    RegionIterator iter = new RegionIterator(rgn);</div><div class="line">    Rect r = new Rect();</div><div class="line">    while (iter.next(r)) &#123;</div><div class="line">        canvas.drawRect(r, paint);</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-101edea89e88a9dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>Canvas 并没有提供针对 Region 的绘图方法，这就说明 Region 的本意并不是用来绘图的。对于上面构造的矩形填充，我们完全可以使用 Rect 来代替。</p>
<h6 id="2-间接构造"><a href="#2-间接构造" class="headerlink" title="2. 间接构造"></a>2. 间接构造</h6><p>间接构造主要是通过 public Region()的空构造函数与 set 系列函数相结合来实现的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 空构造函数</div><div class="line">public Region()</div><div class="line"></div><div class="line">// set 系列</div><div class="line">public void setEmpty() // 置空</div><div class="line">public boolean set(Region region)</div><div class="line">public boolean set(Rect r)</div><div class="line">public boolean set(int left, int top, int right, int bottom) </div><div class="line">public boolean setPath(Path path, Region clip)</div></pre></td></tr></table></figure></p>
<blockquote>
<p>无论调用 set 系列函数的 Region 是不是有区域值，当调用 set 系列函数后，原来的区域值就会被替换成 set 系列函数里的区域值。</p>
</blockquote>
<p>其他函数不表，重点介绍 setPath() 函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">boolean setPath(Path path, Region clip)</div></pre></td></tr></table></figure></p>
<p>参数：<br>Path path：用来构造区域的路径。<br>Region clip：与前面的 path 所构成的路径取交集，并将该交集设置为最终的区域。</p>
<p>由于路径有很多种构造方法，而且可以轻易构造出非矩形的路径，因而摆脱了前面的构造函数只能构造矩形区域的限制。但这里有一个问题，即需要指定另一个区域来取交集。当然，如果想显示路径构造的区域，那么 Region clip 参数可以传入一个比 Path 范围大得多的区 域，取完交集之后，当然就是 Path path 参数所对应的区域了。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">public class BaseView extends View &#123;</div><div class="line">    private Paint paint;</div><div class="line">    private Region region;</div><div class="line"></div><div class="line">    public BaseView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line"></div><div class="line">        paint = new Paint();</div><div class="line">        paint.setColor(Color.RED);</div><div class="line">        paint.setStyle(Paint.Style.FILL);</div><div class="line">        // 构造一条椭圆路径</div><div class="line">        Path ovalPath = new Path();</div><div class="line">        RectF rectF = new RectF(50, 50, 200, 500);</div><div class="line">        ovalPath.addOval(rectF, Path.Direction.CCW);</div><div class="line">        // 在 setPath 中传入一个比椭圆区域小的矩形区域，让其取交集</div><div class="line">        region = new Region();</div><div class="line">        region.setPath(ovalPath, new Region(50, 50, 200, 200));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        drawRegion(canvas, region, paint);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void drawRegion(Canvas canvas, Region region, Paint paint) &#123;</div><div class="line">        RegionIterator iterator = new RegionIterator(region);</div><div class="line">        Rect rect = new Rect();</div><div class="line"></div><div class="line">        while (iterator.next(rect)) &#123;</div><div class="line">            canvas.drawRect(rect, paint);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-660aa4a3d927e4e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>左侧分别画出了所构造的椭圆和矩形，二者相交之后，所画出的 Region 对象是如右侧图 像所示的椭圆上部分。</p>
<h4 id="1-4-2-枚举区域——RegionIterator类"><a href="#1-4-2-枚举区域——RegionIterator类" class="headerlink" title="1.4.2 枚举区域——RegionIterator类"></a>1.4.2 枚举区域——RegionIterator类</h4><p>对于特定的区域，可以使用多个矩形来表示其大致形状。事实上，如果矩形足够小，一定数量的矩形就能够精确表示区域的形状。也就是说，一定数量的矩形所合成的形状也可以代表区域的形状。RegionIterator 类就实现了获取组成区域的矩形集的功能。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 构造函数：根据区域构建对应的矩形集。</div><div class="line">RegionIterator(Region region)</div><div class="line">// 获取下一个矩形,将结果保存在参数 Rect r 中。</div><div class="line">boolean next(Rect r)</div></pre></td></tr></table></figure></p>
<p>前面提到，由于在 Canvas 中没有直接绘制 Region 的函数，想要绘制一个区域，就只能通过 RegionIterator 类构造矩形集来逼近显示区域，所以 drawRegion()函数的具体实现如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">private void drawRegion (Canvas canvas, Region rgn, Paint paint) &#123;</div><div class="line">    RegionIterator iter = new RegionIterator(rgn);</div><div class="line">    Rect r = new Rect();</div><div class="line">    while (iter.next(r)) &#123;</div><div class="line">        canvas.drawRect(r, paint);</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>首先根据区域构造一个矩形集，然后利用next(Rect r)函数来逐个获取所有矩形并绘制出来，最终得到的就是整个区域。如果我们想画一个椭圆区域，并且把画笔样式从 FILL 改为 STROKE，则效果更清楚。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Paint paint = new Paint();</div><div class="line">paint.setColor(Color.RED);</div><div class="line">paint.setStyle(Paint.Style.STROKE);</div><div class="line">// 构造一条椭圆路径</div><div class="line">Path ovalPath = new Path();</div><div class="line">RectF rect = new RectF(50, 50, 200, 500); </div><div class="line">ovalPath.addOval(rect, Path.Direction.CCW);</div><div class="line">// 构造椭圆区域</div><div class="line">Region rgn = new Region();</div><div class="line">rgn.setPath(ovalPath, new Region(50, 50, 200, 500)); </div><div class="line">drawRegion(canvas,rgn,paint);</div></pre></td></tr></table></figure></p>
<p>在代码中，同样先构造了一条椭圆路径，然后在形成 Region 时传入一个与构造的椭圆区域相同大小的矩形，所以取交集之后的结果就是椭圆路径所对应的区域。效果如下图所示：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-3701ef81c0abbaab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>从效果图中可以明显看出，在绘制 Region 对象时，其实就是先将其转换成矩形集，然后利用画笔将每个矩形画出来而已。</p>
<h4 id="1-4-3-区域相交"><a href="#1-4-3-区域相交" class="headerlink" title="1.4.3 区域相交"></a>1.4.3 区域相交</h4><p>Region 不是用来绘图的，而是在区域的相交操作中。</p>
<h6 id="1-union-函数"><a href="#1-union-函数" class="headerlink" title="1. union()函数"></a>1. union()函数</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">boolean union(Rect r)</div></pre></td></tr></table></figure>
<p>该函数用于与指定矩形取并集，即将 Rect 所指定的矩形加入当前区域中。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">paint = new Paint();</div><div class="line">paint.setColor(Color.RED);</div><div class="line">paint.setStyle(Paint.Style.FILL);</div><div class="line">region = new Region(20, 20, 200, 100);</div><div class="line">region.union(new Rect(20, 20, 50, 300));</div><div class="line"></div><div class="line">drawRegion(canvas, region, paint);</div></pre></td></tr></table></figure></p>
<p>将横向、竖向两个矩形区域合并，效果图如下：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-b3ceac258f472065.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="2-区域操作"><a href="#2-区域操作" class="headerlink" title="2. 区域操作"></a>2. 区域操作</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">boolean op(Rect rect, Op op)</div><div class="line">boolean op(int left, int top, int right, int bottom, Op op)</div><div class="line">boolean op(Region, Op)</div></pre></td></tr></table></figure>
<p>操作结果赋给当前的 Region 对象。如果计算成功，返回 true；否则返回 false。</p>
<p>Op 参数值及含义：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public enum Op &#123;</div><div class="line">    DIFFERENCE(0), // 最终区域为 region1 与 region2 不同的区域</div><div class="line">    INTERSECT(1), // 最终区域为 region1 与 region2 相交的区域</div><div class="line">    UNION(2), // 最终区域为 region1 与 region2 组合在一起的区域</div><div class="line">    XOR(3), // 最终区域为 region1 与 region2 相交之外的区域</div><div class="line">    REVERSE_DIFFERENCE(4), // 最终区域为 region2 与 region1 不同的区域</div><div class="line">    REPLACE(5); // 最终区域为 region2 的区域</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line">public class BaseView extends View &#123;</div><div class="line">    private Paint paint, paintFill;</div><div class="line">    private Region region1,region2,region3,region4,region5,region6,region7,region8,region9,region10,region11,region12;</div><div class="line">    private Rect rect1,rect2,rect3,rect4,rect5,rect6,rect7,rect8,rect9,rect10,rect11,rect12;</div><div class="line"></div><div class="line">    public BaseView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line"></div><div class="line">        paint = generatePaint(Color.RED, Paint.Style.STROKE, 2);</div><div class="line">        paintFill = generatePaint(Color.GREEN, Paint.Style.FILL, 0);</div><div class="line"></div><div class="line">        rect1 = new Rect(100, 140, 400, 240);</div><div class="line">        rect2 = new Rect(200, 40, 300, 340);</div><div class="line">        rect3 = new Rect(500, 140, 800, 240);</div><div class="line">        rect4 = new Rect(600, 40, 700, 340);</div><div class="line">        rect5 = new Rect(900, 140, 1200, 240);</div><div class="line">        rect6 = new Rect(1000, 40, 1100, 340);</div><div class="line"></div><div class="line">        rect7 = new Rect(100, 540, 400, 640);</div><div class="line">        rect8 = new Rect(200, 440, 300, 740);</div><div class="line">        rect9 = new Rect(500, 540, 800, 640);</div><div class="line">        rect10 = new Rect(600, 440, 700, 740);</div><div class="line">        rect11 = new Rect(900, 540, 1200, 640);</div><div class="line">        rect12 = new Rect(1000, 440, 1100, 740);</div><div class="line"></div><div class="line">        region1 = new Region(rect1);</div><div class="line">        region2 = new Region(rect2);</div><div class="line">        region1.op(region2, Region.Op.DIFFERENCE);</div><div class="line">        region3 = new Region(rect3);</div><div class="line">        region4 = new Region(rect4);</div><div class="line">        region3.op(region4, Region.Op.INTERSECT);</div><div class="line">        region5 = new Region(rect5);</div><div class="line">        region6 = new Region(rect6);</div><div class="line">        region5.op(region6, Region.Op.UNION);</div><div class="line">        region7 = new Region(rect7);</div><div class="line">        region8 = new Region(rect8);</div><div class="line">        region7.op(region8, Region.Op.XOR);</div><div class="line">        region9 = new Region(rect9);</div><div class="line">        region10 = new Region(rect10);</div><div class="line">        region9.op(region10, Region.Op.REVERSE_DIFFERENCE);</div><div class="line">        region11 = new Region(rect11);</div><div class="line">        region12 = new Region(rect12);</div><div class="line">        region11.op(region12, Region.Op.REPLACE);</div><div class="line">    &#125;</div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        canvas.drawRect(rect1, paint);</div><div class="line">        canvas.drawRect(rect2, paint);</div><div class="line">        drawRegion(canvas, region1, paintFill);</div><div class="line">        canvas.drawRect(rect3, paint);</div><div class="line">        canvas.drawRect(rect4, paint);</div><div class="line">        drawRegion(canvas, region3, paintFill);</div><div class="line">        canvas.drawRect(rect5, paint);</div><div class="line">        canvas.drawRect(rect6, paint);</div><div class="line">        drawRegion(canvas, region5, paintFill);</div><div class="line">        canvas.drawRect(rect7, paint);</div><div class="line">        canvas.drawRect(rect8, paint);</div><div class="line">        drawRegion(canvas, region7, paintFill);</div><div class="line">        canvas.drawRect(rect9, paint);</div><div class="line">        canvas.drawRect(rect10, paint);</div><div class="line">        drawRegion(canvas, region9, paintFill);</div><div class="line">        canvas.drawRect(rect11, paint);</div><div class="line">        canvas.drawRect(rect12, paint);</div><div class="line">        drawRegion(canvas, region11, paintFill);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void drawRegion(Canvas canvas, Region region, Paint paint) &#123;</div><div class="line">        RegionIterator iterator = new RegionIterator(region);</div><div class="line">        Rect rect = new Rect();</div><div class="line"></div><div class="line">        while (iterator.next(rect)) &#123;</div><div class="line">            canvas.drawRect(rect, paint);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private Paint generatePaint(int color, Paint.Style style, int width) &#123;</div><div class="line">        Paint paint = new Paint();</div><div class="line">        paint.setColor(color);</div><div class="line">        paint.setStyle(style);</div><div class="line">        paint.setStrokeWidth(width);</div><div class="line">        return paint;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-fced149dfa37297a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="依次为：DIFFERENCE、INTERSECT、UNION、XOR、REVERSE_DIFFERENCE、REPLACE"></p>
<h6 id="op-的重载"><a href="#op-的重载" class="headerlink" title="op 的重载"></a>op 的重载</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">boolean op(Rect rect, Region region, Op op)</div><div class="line">boolean op(Region region1, Region region2, Region.Op op)</div></pre></td></tr></table></figure>
<p>这两个函数允许我们传入两个 Region 对象进行区域操作，并将操作结果赋给当前的 Region 对象。同样，当操作成功时，返回 true；否则返回 false。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Region region1 = new Region(100,100,400,200);</div><div class="line">Region region2 = new Region(200,0,300,300);</div><div class="line">Region region = new Region();</div><div class="line">region.op(region1, region2, Region.Op.INTERSECT);</div></pre></td></tr></table></figure></p>
<p>在这里，将 region1、region2 相交的结果赋给 Region 对象。</p>
<h4 id="1-4-4-其他函数"><a href="#1-4-4-其他函数" class="headerlink" title="1.4.4 其他函数"></a>1.4.4 其他函数</h4><h6 id="1-几个判断方法"><a href="#1-几个判断方法" class="headerlink" title="1. 几个判断方法"></a>1. 几个判断方法</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 判断该区域是否为空</div><div class="line">public boolean isEmpty();</div><div class="line">// 判断该区域是否是一个矩阵</div><div class="line">public boolean isRect();</div><div class="line">// 判断该区域是否是多个矩阵的组合</div><div class="line">public boolean isComplex();</div></pre></td></tr></table></figure>
<h6 id="2-getBound-系列函数"><a href="#2-getBound-系列函数" class="headerlink" title="2. getBound 系列函数"></a>2. getBound 系列函数</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 返回能够包裹当前路径的最小矩形</div><div class="line">public Rect getBounds()</div><div class="line">public boolean getBounds(Rect r)</div><div class="line">// 返回当前矩形所对应的 Path 对象</div><div class="line">public Path getBoundaryPath()</div><div class="line">public boolean getBoundaryPath(Path path)</div></pre></td></tr></table></figure>
<h6 id="3-是否包含"><a href="#3-是否包含" class="headerlink" title="3. 是否包含"></a>3. 是否包含</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 判断该区域是否包含某个点</div><div class="line">public boolean contains(int x, int y);</div><div class="line">// 判断该区域是否包含某个矩形</div><div class="line">public boolean quickContains(Rect r)</div><div class="line">public boolean quickContains(int left, int top, int right,int bottom)</div></pre></td></tr></table></figure>
<h6 id="4-是否相交"><a href="#4-是否相交" class="headerlink" title="4. 是否相交"></a>4. 是否相交</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 判断该区域是否没有和指定矩形相交</div><div class="line">public boolean quickReject(Rect r)</div><div class="line">public boolean quickReject(int left, int top, int right, int bottom);</div><div class="line">// 判断该区域是否没有和指定区域相交</div><div class="line">public boolean quickReject(Region rgn)</div></pre></td></tr></table></figure>
<h6 id="5-平移变换"><a href="#5-平移变换" class="headerlink" title="5. 平移变换"></a>5. 平移变换</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// 将 Region 对象向 X 轴平移 dx 距离，向 Y 轴平移 dy 距离，</div><div class="line">// 并将结果赋给当前的 Region 对象。X 轴向右是正方向，Y 轴向下是正方向。</div><div class="line">public void translate(int dx, int dy)</div><div class="line">// 将 Region 对象向 X 轴平移 dx 距离，向 Y 轴平移 dy 距离。</div><div class="line">// 与上一个函数不同的是，该函数将结果赋给 dst 对象，</div><div class="line">// 而当前 Region 对象的值保持不变。</div><div class="line">public void translate(int dx, int dy, Region dst)</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/Custom View/01.3 精通自定义 View 之绘图基础（三）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/01/Custom View/01.3 精通自定义 View 之绘图基础（三）/" itemprop="url">01.3 精通自定义 View 之绘图基础（三）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-01T13:09:00+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><meta name="referrer" content="no-referrer"></p>
<h2 id="1-3-文字"><a href="#1-3-文字" class="headerlink" title="1.3 文字"></a>1.3 文字</h2><h4 id="1-3-1-Paint设置"><a href="#1-3-1-Paint设置" class="headerlink" title="1.3.1 Paint设置"></a>1.3.1 Paint设置</h4><p>Paint 与文字相关的设置方法有如下几个：</p>
<ul>
<li>普通设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 设置画笔宽度</div><div class="line">paint.setStrokeWidth (5); </div><div class="line">// 指定是否使用抗锯齿功能。如果使用,则会使绘图速度变慢</div><div class="line">paint.setAntiAlias(true);</div><div class="line">// 绘图样式,对于文字和几何图形都有效</div><div class="line">paint.setStyle(Paint.Style.FILL);</div><div class="line">// 设置文字对齐方式： Align.CENTER、Align.LEFT、Align.RIGHT</div><div class="line">paint.setTextAlign(Align.CENTER);</div><div class="line">// 设置文字大小</div><div class="line">paint.setTextSize(12);</div></pre></td></tr></table></figure>
<ul>
<li>样式设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// 设置是否为粗体文字</div><div class="line">paint.setFakeBoldText(true); </div><div class="line">// 设置下画线</div><div class="line">paint.setUnderlineText(true); </div><div class="line">// 设置字体水平倾斜度,普通斜体字设为-0.25,右为负左为正</div><div class="line">paint.setTextSkewX((float) -0.25); </div><div class="line">// 设置带有删除线效果</div><div class="line">paint.setStrikeThruText(true);</div></pre></td></tr></table></figure>
<ul>
<li>其他设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 只会将水平方向拉伸,高度不会变</div><div class="line">paint.setTextScaleX(2);</div></pre></td></tr></table></figure>
<h6 id="1-填充样式的区别"><a href="#1-填充样式的区别" class="headerlink" title="1. 填充样式的区别"></a>1. 填充样式的区别</h6><p>paint.setStyle()函数对文字和几何图形都有效。下面就来看看不同的填充样式对文字的影响：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setStrokeWidth(5);</div><div class="line">mPaint.setAntiAlias(true);</div><div class="line">mPaint.setTextSize(100);</div><div class="line"></div><div class="line">mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">canvas.drawText(&quot;先小涛 STROKE&quot;, 100, 200, mPaint);</div><div class="line">mPaint.setStyle(Paint.Style.FILL);</div><div class="line">canvas.drawText(&quot;先小涛 FILL&quot;, 100, 320, mPaint);</div><div class="line">mPaint.setStyle(Paint.Style.FILL_AND_STROKE);</div><div class="line">canvas.drawText(&quot;先小涛 FILL_AND_STROKE&quot;, 100, 440, mPaint);</div></pre></td></tr></table></figure></p>
<p>效果图如下：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-16b11cc8b1731a0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体填充样式"></p>
<h6 id="2-setTextAlign-函数"><a href="#2-setTextAlign-函数" class="headerlink" title="2. setTextAlign()函数"></a>2. setTextAlign()函数</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public void setTextAlign(Align align)</div></pre></td></tr></table></figure>
<p>用于设置所要绘制的字符串与起始点的相对位置。参数 Align align 的取值如下：</p>
<ul>
<li>Align.LEFT：居左绘制，即通过 drawText()函数指定的起始点在最左侧，文字从起始点位置开始绘制。</li>
<li>Align.CENTER：居中绘制，即通过 drawText()函数指定的起始点在文字中间位置。</li>
<li>Align.RIGHT：居右绘制，即通过 drawText()函数指定的起始点在文字右侧位置。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mLinePaint = new Paint();</div><div class="line">mLinePaint.setColor(Color.BLUE);</div><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setStrokeWidth(5);</div><div class="line">mPaint.setAntiAlias(true);</div><div class="line">mPaint.setTextSize(80);</div><div class="line"></div><div class="line">canvas.drawCircle(400, 100, 5, mLinePaint);</div><div class="line">canvas.drawLine(400, 100, 400, 300, mLinePaint);</div><div class="line">mPaint.setTextAlign(Paint.Align.LEFT);</div><div class="line">canvas.drawText(&quot;先小涛&quot;, 400, 100, mPaint);</div><div class="line">mPaint.setTextAlign(Paint.Align.CENTER);</div><div class="line">canvas.drawText(&quot;先小涛&quot;, 400, 200, mPaint);</div><div class="line">mPaint.setTextAlign(Paint.Align.RIGHT);</div><div class="line">canvas.drawText(&quot;先小涛&quot;, 400, 300, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-ff624351d68401c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="setTextAlign 效果图"></p>
<p>从效果图中可以看出，当居左对齐(Align.LEFT)时，整个字符串都在起始点(400,100) 的右侧，也就是说,通过 drawText()函数指定的起始点(400,100)是居左的。同样，当居右对齐(Align.RIGHT)时，起始点也是居右的，也就是说，所有文字都在起始点(400,100)的左侧。</p>
<h6 id="3-设置字体样式"><a href="#3-设置字体样式" class="headerlink" title="3. 设置字体样式"></a>3. 设置字体样式</h6><p>1）常规设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 设置是否粗体。当取 true 时，表示是粗体。</div><div class="line">void setFakeBoldText(boolean fakeBoldText)</div><div class="line">// 是否显示文字下画线。当取 true 时，显示下画线。</div><div class="line">void setUnderlineText(boolean underlineText)</div><div class="line">// 是否显示中间删除线。当取 true 时，显示中间删除线。</div><div class="line">void setStrikeThruText(boolean strikeThruText)</div></pre></td></tr></table></figure></p>
<p>示例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">canvas.drawText(&quot;先小涛 DEFAULT&quot;, 100, 200, mPaint);</div><div class="line">mPaint.setFakeBoldText(true);</div><div class="line">mPaint.setUnderlineText(true);</div><div class="line">mPaint.setStrikeThruText(true);</div><div class="line">canvas.drawText(&quot;先小涛 SETTING&quot;, 100, 300, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-16487debfb27c72b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体设置效果图"></p>
<p>2）字体倾斜度设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void setTextSkewX(float skewX)</div></pre></td></tr></table></figure></p>
<p>该函数用于设置字体倾斜度。参数 float skewX 的默认值是 0，取负值时文字向右倾斜，取正值时文字向左倾斜，Word 文档中倾斜字体的倾斜度是 -0.25f。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setTextSize(80);</div><div class="line"></div><div class="line">// 正常样式</div><div class="line">canvas.drawText(mName, 100, 200, mPaint);</div><div class="line">// 向右倾斜</div><div class="line">mPaint.setTextSkewX(-0.25f);</div><div class="line">canvas.drawText(mName, 100, 300, mPaint);</div><div class="line">// 向左倾斜</div><div class="line">mPaint.setTextSkewX(0.25f);</div><div class="line">canvas.drawText(mName, 100, 400, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-5092c1c4b245d5fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体倾斜度设置：正常、向右、向左"></p>
<h6 id="4-水平拉伸"><a href="#4-水平拉伸" class="headerlink" title="4. 水平拉伸"></a>4. 水平拉伸</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void setTextScaleX(float scaleX)</div></pre></td></tr></table></figure>
<p>该函数用于在水平方向拉伸文字。参数 float scaleX 表示拉伸倍数，当取值为 1 时，表示不拉伸。默认为不拉伸。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 正常样式</div><div class="line">canvas.drawText(mName, 100, 200, mPaint);</div><div class="line">// 拉伸两倍</div><div class="line">mPaint.setTextScaleX(2f);</div><div class="line">canvas.drawText(mName, 100, 300, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-f24aeccf2715d7a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体水平拉伸"></p>
<h4 id="1-3-2-Canvas绘制文本"><a href="#1-3-2-Canvas绘制文本" class="headerlink" title="1.3.2 Canvas绘制文本"></a>1.3.2 Canvas绘制文本</h4><h6 id="1-普通绘制"><a href="#1-普通绘制" class="headerlink" title="1. 普通绘制"></a>1. 普通绘制</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// 该函数可以指定起始点(x, y)来绘制文字</div><div class="line">void drawText(String text, float x, float y, Paint paint)</div><div class="line">// 通过指定字符串中字符的起始和终止位置截取字符串的一部分绘制</div><div class="line">void drawText(String text, int start, int end, float x, float y, Paint paint)</div><div class="line">void drawText(char[] text, int index, int count, float x, float y, Paint paint)</div><div class="line">void drawText(CharSequence text, int start, </div><div class="line">              int end, float x, float y, Paint paint)</div></pre></td></tr></table></figure>
<p>参数：<br>int start：表示起始绘制字符所在字符串中的索引。<br>int end：表示结束绘制字符所在字符串中的索引。<br>int index：指定起始绘制字符的位置。<br>int count：指定从起始绘制字符开始绘制几个字符。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">canvas.drawText(&quot;先小涛后大浪&quot;, 1, 4, 100, 200, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-b6c9d809d7d02707.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="2-逐个指定文字位置"><a href="#2-逐个指定文字位置" class="headerlink" title="2. 逐个指定文字位置"></a>2. 逐个指定文字位置</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">void drawPosText(String text, float[] pos, Paint paint)</div><div class="line">void drawPosText(char[] text, int index, int count, float[] pos, Paint paint)</div></pre></td></tr></table></figure>
<p>参数：</p>
<ul>
<li>char[] text/String text：要绘制的字符串。</li>
<li>int index：第一个要绘制的文字的索引。</li>
<li>int count：要绘制的文字的个数，用来计算最后一个文字的位置，从第一个绘制的文字开始算起。</li>
<li>float[] pos：要绘制的每个文字的具体位置，同样两两一组，如{x1,y1,x2,y2,x3,y3,…}。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">public class TestView extends View &#123;</div><div class="line"></div><div class="line">    private Paint mPaint;</div><div class="line">    private String mName = &quot;先小涛后大浪&quot;;</div><div class="line">    private float[] pos = &#123;80, 180, 80, 280, 80, 380,</div><div class="line">                           200, 180, 200, 280, 200, 380&#125;;</div><div class="line"></div><div class="line">    public TestView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        mPaint = new Paint();</div><div class="line">        mPaint.setColor(Color.RED);</div><div class="line">        mPaint.setTextSize(80);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        canvas.drawPosText(mName, pos, mPaint);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-1b7f44f3ba8837d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="3-沿路径绘制"><a href="#3-沿路径绘制" class="headerlink" title="3. 沿路径绘制"></a>3. 沿路径绘制</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">void drawTextOnPath (String text, Path path, float hOffset, </div><div class="line">                     float vOffset, Paint paint)</div><div class="line">void drawTextOnPath (char[] text, int index, int count, Path path, </div><div class="line">                     float hOffset, float vOffset, Paint paint)</div></pre></td></tr></table></figure>
<ul>
<li>float hOffset：与路径起始点的水平偏移量。 </li>
<li>float vOffset：与路径中心的垂直偏移量。</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setTextSize(50);</div><div class="line">mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">mName = &quot;先小涛后大浪&quot;;</div><div class="line">mPath1 = new Path();</div><div class="line">mPath1.addCircle(220, 300, 150, Path.Direction.CCW);</div><div class="line">mPath2 = new Path();</div><div class="line">mPath2.addCircle(600, 300, 150, Path.Direction.CCW);</div><div class="line"></div><div class="line">// 辅助中线</div><div class="line">canvas.drawLine(70, 300, 750, 300, mPaint);</div><div class="line">canvas.drawPath(mPath1, mPaint);</div><div class="line">canvas.drawPath(mPath2, mPaint);</div><div class="line">mPaint.setColor(Color.BLUE);</div><div class="line">canvas.drawTextOnPath(mName, mPath1, 0, 0, mPaint);</div><div class="line">canvas.drawTextOnPath(mName, mPath2, 80, 50, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-3b672e6d1a2b4c3e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h4 id="1-3-3-设置字体样式"><a href="#1-3-3-设置字体样式" class="headerlink" title="1.3.3 设置字体样式"></a>1.3.3 设置字体样式</h4><p>在 Paint 中有一个函数是专门用来设置字体样式的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Typeface setTypeface(Typeface typeface)</div></pre></td></tr></table></figure></p>
<p>Typeface 是专门用来设置字体样式的类，通过 paint.setTypeface()函数来指定即将绘制的文字的字体样式。可以指定系统中的字体样式，也可以在自定义的样式文件中获取。在构建 Typeface 类时，可以指定所用样式的正常体、斜体、粗体等。如果在指定样式中没有相关文 字的样式，就会用系统默认的样式来显示，一般默认是宋体。</p>
<h6 id="1-使用系统中的字体样式"><a href="#1-使用系统中的字体样式" class="headerlink" title="1. 使用系统中的字体样式"></a>1. 使用系统中的字体样式</h6><p>1）使用 Android 自带的字体样式<br>在 Typeface 类中保存着三种自带的字体样式：Typeface.SANS_SERIF、Typeface.MONOSPACE 和 Typeface.SERIF。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 衬线字体</div><div class="line">mPaint.setTypeface(Typeface.SERIF);</div><div class="line">canvas.drawText(mName, 100, 100, mPaint);</div><div class="line">// 设置等宽字体</div><div class="line">mPaint.setTypeface(Typeface.MONOSPACE);</div><div class="line">canvas.drawText(mName, 100, 170, mPaint);</div><div class="line">// 无衬线字体</div><div class="line">mPaint.setTypeface(Typeface.SANS_SERIF);</div><div class="line">canvas.drawText(mName, 100, 240, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-bcad462033b71603.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="系统字体样式"><br>由于这三种字体样式对中文的支持不是很好。所以，当遇到不支持的文字时，会使用系统默认的样式来写。对中国用户而言，系统默认的字体一般是 DroidSansFallback，所以用这三种样式的文字写中文时是看不到差别的，我们一般不会使用这三种字体样式。</p>
<p>2）defaultFromStyle()函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Typeface defaultFromStyle(int style)</div></pre></td></tr></table></figure></p>
<p>该函数会根据字体样式获取对应的默认字体。参数 int style 的取值如下：</p>
<ul>
<li>Typeface.NORMAL：正常字体。</li>
<li>Typeface.BOLD：粗体。</li>
<li>Typeface.ITALIC：斜体。</li>
<li>Typeface.BOLD_ITALIC：粗斜体。</li>
</ul>
<p>如果系统默认的字体是宋体，那么当指定defaultFromStyle(Typeface.BOLD_ITALIC)时，获取的将是粗斜体的宋体样式。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setTextSize(50);</div><div class="line">mPaint.setAntiAlias(true);</div><div class="line">mName = &quot;先小涛 xian@163.com&quot;;</div><div class="line">Typeface typeface = Typeface.defaultFromStyle(Typeface.BOLD_ITALIC);</div><div class="line">mPaint.setTypeface(typeface);</div><div class="line"></div><div class="line">canvas.drawText(mName, 100, 100, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-b07302336ad691c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>3）create(String familyName, int style)函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Typeface create(String familyName, int style)</div></pre></td></tr></table></figure></p>
<p>该函数直接通过指定字体名来加载系统中自带的字体样式。如果字体样式不存在，则会用系统样式替代并返回。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">String familyName = &quot;宋体&quot;;</div><div class="line">Typeface font = Typeface.create(familyName, Typeface.NORMAL);</div><div class="line">mPaint.setTypeface(font);</div><div class="line"></div><div class="line">canvas.drawText(mName, 100, 100, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-2dc4d2f717e87dc7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="2-自定义字体样式"><a href="#2-自定义字体样式" class="headerlink" title="2. 自定义字体样式"></a>2. 自定义字体样式</h6><p>一般而言，我们不会指定系统自带的字体样式。因为除 Android 自带的三种字体样式以外，其他字体样式并不一定在每款手机上都有预装。所以，我们一般会选择加载自定义的字体文件来绘制文字，这样才不至于在每款手机上的表现不一样。</p>
<p>如果要自定义字体样式，就需要从外部字体文件中加载我们所需的字形，这时所使用的 Typeface 构造函数有如下三个:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Typeface createFromAsset(AssetManager mgr, String path)</div><div class="line">Typeface createFromFile(String path)</div><div class="line">Typeface createFromFile(File path)</div></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">AssetManager manager = context.getAssets();</div><div class="line">// 加载字体文件：assets/fonts/xian.ttf</div><div class="line">Typeface typeface = Typeface.createFromAsset(manager, &quot;fonts/xian.ttf&quot;);</div><div class="line">mPaint.setTypeface(typeface);</div><div class="line"></div><div class="line">canvas.drawText(mName, 100, 200, mPaint);</div></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14186083-ee96a269fc0c1fe5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>加载 res/font/xian.ttf 字体文件方式：<br>Typeface typeface = ResourcesCompat.getFont(context, R.font.xian);</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/Custom View/01.2 精通自定义 View 之绘图基础（二）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="King">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/01/Custom View/01.2 精通自定义 View 之绘图基础（二）/" itemprop="url">01.2 精通自定义 View 之绘图基础（二）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-01T09:41:00+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Custom-View/" itemprop="url" rel="index">
                    <span itemprop="name">Custom View</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><meta name="referrer" content="no-referrer"></p>
<h2 id="1-2-路径"><a href="#1-2-路径" class="headerlink" title="1.2 路径"></a>1.2 路径</h2><h4 id="1-2-1-概述"><a href="#1-2-1-概述" class="headerlink" title="1.2.1 概述"></a>1.2.1 概述</h4><p>画笔所画出来的一段不间断的曲线就是路径。在 Android 中，Path 类就代表路径。在 Canvas 中绘制路径的方法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void drawPath(Path path, Paint paint)</div></pre></td></tr></table></figure></p>
<h4 id="1-2-2-直线路径"><a href="#1-2-2-直线路径" class="headerlink" title="1.2.2 直线路径"></a>1.2.2 直线路径</h4><p>画一条直线路径,一般涉及下面三个函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// (x1,y1)是直线的起始点，即将直线路径的绘制点定在(x1,y1)位置</div><div class="line">void moveTo(float x1, float y1)</div><div class="line">// (x2,y2)是直线的终点，又是下一次绘制直线路径的起始点；lineTo()函数可以一直使用。</div><div class="line">void lineTo(float x2, float y2)</div><div class="line">// 如果连续画了几条直线，但没有形成闭环，</div><div class="line">// 那么调用 close()函数会将路径首尾点连接起来，形成闭环。</div><div class="line">void close()</div></pre></td></tr></table></figure></p>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-8e38ddf81a7fe2a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="闭环 &amp; 不闭环三角形"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">// 初始化</div><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">mPaint.setStrokeWidth(5);</div><div class="line">mPath = new Path();</div><div class="line"></div><div class="line">// 闭环</div><div class="line">mPath.moveTo(20, 20);</div><div class="line">mPath.lineTo(20, 120);</div><div class="line">mPath.lineTo(300, 120);</div><div class="line">mPath.close();</div><div class="line">canvas.drawPath(mPath, mPaint);</div><div class="line"></div><div class="line">// 不闭环</div><div class="line">mPath.moveTo(320, 20);</div><div class="line">mPath.lineTo(320, 120);</div><div class="line">mPath.lineTo(600, 120);</div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure></p>
<p>闭合三角形：先沿逆时针方向画了两条直线，分别是从(10, 10)到(10, 100)和从(10, 100)到(300, 100)，然后利用 path.close()函数将路径闭合，路径的终点(300,100)就会自行向路径的起始点 (10,10)画一条闭合线，所以最终我们看到的是一个路径闭合的三角形。</p>
<h4 id="1-2-3-弧线路径"><a href="#1-2-3-弧线路径" class="headerlink" title="1.2.3 弧线路径"></a>1.2.3 弧线路径</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void arcTo(RectF oval, float startAngle, float sweepAngle)</div></pre></td></tr></table></figure>
<p>这是一个画弧线路径的方法，弧线是从椭圆上截取的一部分。<br>参数:</p>
<ul>
<li>RectF oval：生成椭圆的矩形。</li>
<li>float startAngle：弧开始的角度，以 X 轴正方向为 0°。 </li>
<li>float sweepAngle：弧持续的角度。</li>
</ul>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-7331c6d8b5f45ab1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="效果图"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">// 初始化</div><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">mPaint.setStrokeWidth(5);</div><div class="line">mRect = new RectF(100, 20, 200, 100);</div><div class="line">mPath = new Path();</div><div class="line">mPath.moveTo(20, 20);</div><div class="line">mPath.arcTo(mRect, 0, 90);</div><div class="line"></div><div class="line">// onDraw</div><div class="line">mPaint.setColor(Color.LTGRAY);</div><div class="line">canvas.drawRect(mRect, mPaint);</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure></p>
<p>上述示例中弧最终还是会和起始点(10,10)连接起来。因为在默认情况下路径都是连贯的，除非以下两种情况：</p>
<ul>
<li>调用 addXXX 系列函数(参见 1.2.4 节)，将直接添加固定形状的路径。</li>
<li>调用 moveTo()函数改变绘制起始位置。</li>
</ul>
<p>如果不想连接起来，需要使用 Path 类提供的另外两个重载方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">void arcTo(float left, float top, float right, float bottom, </div><div class="line">           float startAngle, float sweepAngle, boolean forceMoveTo)</div><div class="line">void arcTo(RectF oval, float startAngle, float sweepAngle, boolean forceMoveTo)</div></pre></td></tr></table></figure></p>
<p>参数 boolean forceMoveTo 的含义是是否强制将弧的起始点作为绘制起始位置。</p>
<p>将上面的代码稍加改造：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// mPath.arcTo(mRect, 0, 90);</div><div class="line">mPath.arcTo(mRect, 0, 90, true);</div></pre></td></tr></table></figure></p>
<p>效果如下：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-df222124d40335a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h4 id="1-2-4-addXXX系列函数"><a href="#1-2-4-addXXX系列函数" class="headerlink" title="1.2.4 addXXX系列函数"></a>1.2.4 addXXX系列函数</h4><p>路径一般都是连贯的，而 addXXX 系列函数可以让我们直接往 Path 中添加一些曲线，而不必考虑连贯性。</p>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-37511e3dbeff4d95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">mPaint.setStrokeWidth(5);</div><div class="line"></div><div class="line">mPath = new Path();</div><div class="line">mPath.moveTo(40, 40);</div><div class="line">mPath.lineTo(100, 100);</div><div class="line">mRect = new RectF(100, 100, 200, 200);</div><div class="line">mPath.addArc(mRect, 0, 90);</div><div class="line"></div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure></p>
<p>先绘制了从(40,40)到(100,100)的线段，但是在我们往路径中添加了一条弧线之后，弧线并没有与线段连接。除了 addArc()函数，Path 类还提供了一系列的 add 函数：</p>
<h6 id="1-添加矩形路径"><a href="#1-添加矩形路径" class="headerlink" title="1.添加矩形路径"></a>1.添加矩形路径</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">void addRect(float left, float top, float right, float bottom, </div><div class="line">             Path.Direction dir)</div><div class="line">void addRect(RectF rect, Path.Direction dir)</div></pre></td></tr></table></figure>
<p>这里 Path 类创建矩形路径的参数与 Canvas 绘制矩形的参数差不多,唯一不同的是增加了 Path.Direction 参数。Path.Direction 参数有两个值。</p>
<ul>
<li>Path.Direction.CCW：是 counter-clockwise 的缩写，指创建逆时针方向的矩形路径。</li>
<li>Path.Direction.CW：是 clockwise 的缩写，指创建顺时针方向的矩形路径。</li>
</ul>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-03911176aaff56ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">public TestView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">    super(context, attrs);</div><div class="line"></div><div class="line">    mPaint = new Paint();</div><div class="line">    mPaint.setColor(Color.LTGRAY);</div><div class="line">    mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">    mPaint.setStrokeWidth(5);</div><div class="line"></div><div class="line">    mTextPaint = new Paint();</div><div class="line">    mTextPaint.setColor(Color.BLUE);</div><div class="line">    mTextPaint.setTextSize(35);</div><div class="line"></div><div class="line">    mStr = &quot;苦心人天不负，有志者事竟成&quot;;</div><div class="line"></div><div class="line">    // 逆时针路径</div><div class="line">    mCCWPath = new Path();</div><div class="line">    RectF rect1 = new RectF(50, 50, 240, 200);</div><div class="line">    mCCWPath.addRect(rect1, Path.Direction.CCW);</div><div class="line">    // 顺时针路径</div><div class="line">    mCWPath = new Path();</div><div class="line">    RectF rect2 = new RectF(290, 50, 480, 200);</div><div class="line">    mCWPath.addRect(rect2, Path.Direction.CW);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@Override</div><div class="line">protected void onDraw(Canvas canvas) &#123;</div><div class="line">    canvas.drawPath(mCCWPath, mPaint);</div><div class="line">    canvas.drawPath(mCWPath, mPaint);</div><div class="line">    canvas.drawTextOnPath(mStr, mCCWPath, 0, 18, mTextPaint);</div><div class="line">    canvas.drawTextOnPath(mStr, mCWPath, 0, 18, mTextPaint);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>文字是可以依据路径排版的，文字的行走方向依据的就是路径的生成方向。</p>
<h6 id="2-添加圆角矩形路径"><a href="#2-添加圆角矩形路径" class="headerlink" title="2.添加圆角矩形路径"></a>2.添加圆角矩形路径</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">void addRoundRect(RectF rect, float[] radii, Path.Direction dir)</div><div class="line">void addRoundRect(RectF rect, float rx, float ry, Path.Direction dir)</div></pre></td></tr></table></figure>
<p>矩形的圆角都是利用椭圆生成的。参数：</p>
<ul>
<li>RectF rect：是当前所构造路径的矩形。</li>
<li>Path.Direction dir：依然是指路径的生成方向，当然只对依据路径布局的文字有用。</li>
<li>float[] radii：必须传入 8 个数值，分 4 组，分别对应每个角所使用的椭圆的横轴半径和纵轴半径。如{x1,y1,x2,y2,x3,y3,x4,y4}，其中，x1,y1 对应第一个角(左上角)的用来生成圆角的椭圆的横轴半径和纵轴半径，其他类推……</li>
<li>float rx：生成统一的圆角的椭圆的横轴半径。</li>
<li>float ry：生成统一的圆角的椭圆的纵轴半径。</li>
</ul>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-2f1e571e526983ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">public class TestView extends View &#123;</div><div class="line"></div><div class="line">    private Paint mPaint;</div><div class="line">    private Path mCCWPath, mCWPath;</div><div class="line"></div><div class="line">    public TestView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line"></div><div class="line">        mPaint = new Paint();</div><div class="line">        mPaint.setColor(Color.RED);</div><div class="line">        mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">        mPaint.setAntiAlias(true);</div><div class="line">        mPaint.setStrokeWidth(5);</div><div class="line"></div><div class="line">        // 逆时针路径</div><div class="line">        mCCWPath = new Path();</div><div class="line">        RectF rect1 = new RectF(50, 50, 240, 200);</div><div class="line">        mCCWPath.addRoundRect(rect1, 10, 15, Path.Direction.CCW);</div><div class="line">        // 顺时针路径</div><div class="line">        mCWPath = new Path();</div><div class="line">        RectF rect2 = new RectF(290, 50, 480, 200);</div><div class="line">        float[] radii = &#123;10,15,20,25,30,35,40,45&#125;;</div><div class="line">        mCWPath.addRoundRect(rect2, radii, Path.Direction.CW);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        canvas.drawPath(mCCWPath, mPaint);</div><div class="line">        canvas.drawPath(mCWPath, mPaint);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h6 id="3-添加圆形路径"><a href="#3-添加圆形路径" class="headerlink" title="3.添加圆形路径"></a>3.添加圆形路径</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void addCircle(float x, float y, float radius, Path.Direction dir)</div></pre></td></tr></table></figure>
<p>参数:</p>
<ul>
<li>float x：圆心 X 轴坐标。 </li>
<li>float y：圆心 Y 轴坐标。 </li>
<li>float radius：圆半径。</li>
</ul>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-d00e3789856b37a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mPath = new Path();</div><div class="line">mPath.addCircle(100, 100, 50, Path.Direction.CCW);</div><div class="line"></div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure>
<h6 id="4-添加椭圆路径"><a href="#4-添加椭圆路径" class="headerlink" title="4.添加椭圆路径"></a>4.添加椭圆路径</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void addOval(RectF oval, Path.Direction dir)</div></pre></td></tr></table></figure>
<p>参数:</p>
<ul>
<li>RectF oval：生成椭圆的矩形。</li>
<li>Path.Direction：路径的生成方向。</li>
</ul>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-4c670d0f471cfd02.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mPath = new Path();</div><div class="line">mPath.addOval(new RectF(100, 100, 300, 200), Path.Direction.CCW);</div><div class="line"></div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure>
<h6 id="5-添加弧形路径"><a href="#5-添加弧形路径" class="headerlink" title="5.添加弧形路径"></a>5.添加弧形路径</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">void addArc(float left, float top, float right, float bottom, </div><div class="line">            float startAngle, float sweepAngle)</div><div class="line">void addArc(RectF oval, float startAngle, float sweepAngle)</div></pre></td></tr></table></figure>
<p>参数:</p>
<ul>
<li>RectF oval：弧是椭圆的一部分，这个参数就是生成椭圆的矩形。 </li>
<li>float startAngle：弧开始的角度，以 X 轴正方向为 0°。</li>
<li>float sweepAngel：弧持续的角度。</li>
</ul>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-e199e6473c71e84a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mPath.addArc(new RectF(100, 100, 300, 200), 0, 180);</div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure>
<h4 id="1-2-5-填充模式"><a href="#1-2-5-填充模式" class="headerlink" title="1.2.5 填充模式"></a>1.2.5 填充模式</h4><p>Path 的填充模式与 Paint 的填充模式不同。Path 的填充模式是指填充 Path 的哪部分。Path.FillType 表示 Path 的填充模式，它有 4 个枚举值。</p>
<ul>
<li>FillType.WINDING：默认值，当两个图形相交时，取相交和自身部分显示。 </li>
<li>FillType.EVEN_ODD：取 path 所在并不相交的区域。</li>
<li>FillType.INVERSE_WINDING：取 path 的外部区域。</li>
<li>FillType.INVERSE_EVEN_ODD：取 path 的外部和相交区域。</li>
</ul>
<p>Inverse 就是取反的意思，所以 FillType.INVERSE_WINDING 就是取 FillType.WINDING 的相反部分；同理，FillType.INVERSE_EVEN_ODD 就是取 FillType.EVEN_ODD 的相反部分。</p>
<p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-fa947014b8824235.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mPaint = new Paint();</div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">mPaint.setStyle(Paint.Style.FILL);</div><div class="line">mPaint.setAntiAlias(true);</div><div class="line"></div><div class="line">mPath = new Path();</div><div class="line">mPath.addRect(100, 100, 300, 300, Path.Direction.CW);</div><div class="line">mPath.addCircle(300, 300, 100, Path.Direction.CW);</div><div class="line">mPath.setFillType(Path.FillType.INVERSE_EVEN_ODD);</div><div class="line"></div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure></p>
<h4 id="1-2-6-重置路径"><a href="#1-2-6-重置路径" class="headerlink" title="1.2.6 重置路径"></a>1.2.6 重置路径</h4><h6 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h6><p>当我们需要重绘一条全新的路径时，Android 开发人员为了重复利用空间，允许我们重置路径对象。路径对象一旦被重置，其中保存的所有路径都将被清空，这样我们就不需要重新定义一个路径对象了。重新定义路径对象的问题在于老对象的回收和新对象的内存分配，当然这些过程都是会消耗手机性能的。</p>
<p>系统提供了两个重置路径的方法，分别是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">void reset();</div><div class="line">void rewind();</div></pre></td></tr></table></figure></p>
<p>这两个函数的共同点是都会清空内部所保存的所有路径，但二者也有区别。</p>
<ul>
<li>rewind()函数会清除 FillType 及所有的直线、曲线、点的数据等，但是会保留数据结构。 这样可以实现快速重用，提高一定的性能。例如，重复绘制一类线段，它们的点的数量都相等，那么使用 rewind()函数可以保留装载点数据的数据结构，效率会更高。一定要注意的是，只有在重复绘制相同的路径时，这些数据结构才是可以复用的。</li>
<li>reset()函数类似于新建一个路径对象，它的所有数据空间都会被回收并重新分配，但不会清除 FillType。</li>
</ul>
<h6 id="2-reset-与-FillType"><a href="#2-reset-与-FillType" class="headerlink" title="2.reset()与 FillType"></a>2.reset()与 FillType</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mPath.setFillType(Path.FillType.INVERSE_WINDING);</div><div class="line">mPath.reset();</div><div class="line">mPath.addCircle(100, 100, 50, Path.Direction.CW);</div><div class="line"></div><div class="line">canvas.drawPath(mPath, mPaint);</div></pre></td></tr></table></figure>
<p>效果如下：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-8148a61181bf97db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="reset 不清除 FillType"></p>
<p>把 reset()改成 rewind()。效果如下：<br><img src="https://upload-images.jianshu.io/upload_images/14186083-8112a78ff86dbea8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="rewind 清除 FillType"></p>
<h4 id="1-2-7-示例：蜘蛛网状图"><a href="#1-2-7-示例：蜘蛛网状图" class="headerlink" title="1.2.7 示例：蜘蛛网状图"></a>1.2.7 示例：蜘蛛网状图</h4><p><img src="https://upload-images.jianshu.io/upload_images/14186083-69b3cadcd1005e2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="网游职业分析图"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div></pre></td><td class="code"><pre><div class="line">package com.xxt.xtest;</div><div class="line"></div><div class="line">import android.content.Context;</div><div class="line">import android.graphics.Canvas;</div><div class="line">import android.graphics.Color;</div><div class="line">import android.graphics.Paint;</div><div class="line">import android.graphics.Path;</div><div class="line">import android.util.AttributeSet;</div><div class="line">import android.view.View;</div><div class="line"></div><div class="line">import androidx.annotation.Nullable;</div><div class="line"></div><div class="line">public class SpiderView extends View &#123;</div><div class="line"></div><div class="line">    private Paint mRadarPaint;                  // 蜘蛛网</div><div class="line">    private Paint mRadarLinePaint;              // 蜘蛛网辐射的六根线</div><div class="line">    private Paint mValuePaint;                  // 数据</div><div class="line"></div><div class="line">    private float radius;                       // 网格最大半径</div><div class="line">    private int centerX;                        // 中心 X</div><div class="line">    private int centerY;                        // 中心 Y</div><div class="line"></div><div class="line">    private Path mPath;</div><div class="line">    private int mRadarPaintColor = 0xFF0099CC;  // 网格默认颜色</div><div class="line"></div><div class="line">    private int count = 6;                      // 多边形，默认值为 6</div><div class="line">    private double angle = 2*Math.PI / count;   // 角度，值为 2π / count，默认</div><div class="line"></div><div class="line">    private double[] data = &#123;2,3,1,3,4,3&#125;;      // 数据</div><div class="line">    private int maxValue = 4;                   // 最大值</div><div class="line"></div><div class="line">    public SpiderView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void init() &#123;</div><div class="line">        mRadarPaint = generatePaint(mRadarPaintColor, Paint.Style.FILL);</div><div class="line">        mRadarLinePaint = generatePaint(Color.WHITE, Paint.Style.STROKE);</div><div class="line">        mValuePaint = generatePaint(0xAFFF0000, Paint.Style.FILL);</div><div class="line"></div><div class="line">        mPath = new Path();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private Paint generatePaint(int color, Paint.Style style) &#123;</div><div class="line">        Paint paint = new Paint();</div><div class="line">        paint.setColor(color);</div><div class="line">        paint.setStyle(style);</div><div class="line">        paint.setAntiAlias(true);</div><div class="line">        return paint;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onSizeChanged(int w, int h, int oldw, int oldh) &#123;</div><div class="line">        // 获得布局中心</div><div class="line">        centerX = w / 2;</div><div class="line">        centerY = h / 2;</div><div class="line">        radius = Math.min(w, h) / 2f * 0.8f;</div><div class="line">        postInvalidate();</div><div class="line">        super.onSizeChanged(w, h, oldw, oldh);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line">        // 绘制蜘蛛网格</div><div class="line">        drawPolygon(canvas);</div><div class="line">        // 绘制中线</div><div class="line">        drawLines(canvas);</div><div class="line">        // 画数据图</div><div class="line">        drawRegion(canvas);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void drawPolygon(Canvas canvas) &#123;</div><div class="line">        float r = radius / maxValue;            // r是蜘蛛丝之间的间距</div><div class="line">        for (int i = 1; i &lt;= maxValue; i++) &#123;   // 中心点不用绘制</div><div class="line">            float curR = r * i;                 // 当前半径</div><div class="line">            mPath.reset();</div><div class="line">            for (int j = 0; j &lt; count; j++) &#123;</div><div class="line">                if (j == 0) &#123;</div><div class="line">                    mPath.moveTo(centerX + curR, centerY);</div><div class="line">                &#125; else &#123;</div><div class="line">                    // 根据半径，计算出蜘蛛丝上每个点的坐标</div><div class="line">                    float x = (float) (centerX + curR * Math.cos(angle * j));</div><div class="line">                    float y = (float) (centerY + curR * Math.sin(angle * j));</div><div class="line">                    mPath.lineTo(x, y);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            mPath.close();                      // 闭合路径</div><div class="line">            mRadarPaint.setAlpha(getRadarPaintColor(i));</div><div class="line">            canvas.drawPath(mPath, mRadarPaint);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void drawLines(Canvas canvas) &#123;</div><div class="line">        for (int i = 0; i &lt; count; i++) &#123;</div><div class="line">            mPath.reset();</div><div class="line">            mPath.moveTo(centerX, centerY);</div><div class="line">            float x = (float) (centerX + radius * Math.cos(angle * i));</div><div class="line">            float y = (float) (centerY + radius * Math.sin(angle * i));</div><div class="line">            mPath.lineTo(x, y);</div><div class="line">            canvas.drawPath(mPath, mRadarLinePaint);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void drawRegion(Canvas canvas) &#123;</div><div class="line">        mPath.reset();</div><div class="line">        for (int i = 0; i &lt; count; i++) &#123;</div><div class="line">            double percent = data[i] / maxValue;</div><div class="line">            float x = (float) (centerX + radius * Math.cos(angle * i) * percent);</div><div class="line">            float y = (float) (centerY + radius * Math.sin(angle * i) * percent);</div><div class="line">            if (i == 0) &#123;</div><div class="line">                mPath.moveTo(x, centerY);</div><div class="line">            &#125; else &#123;</div><div class="line">                mPath.lineTo(x, y);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        canvas.drawPath(mPath, mValuePaint);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 由内到外，增加透明度</div><div class="line">     * @param i 第几个网格，从中心点算起</div><div class="line">     * @return int alpha 值</div><div class="line">     */</div><div class="line">    private int getRadarPaintColor(int i) &#123;</div><div class="line">        if (i &gt; count || i &lt; 1) &#123;</div><div class="line">            return 0xFF;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        int alpha = Color.alpha(mRadarPaintColor);</div><div class="line">        int colorStep = alpha / (maxValue - 1) - 10;</div><div class="line">        alpha = alpha - colorStep * (i - 1);</div><div class="line">        return alpha;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">78</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
